(window.webpackJsonp=window.webpackJsonp||[]).push([[6],Array(317).concat([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(326),c=function(){function t(t,e,n,o){this.x=t,this.y=e,this.width=n,this.height=o,this.center=new r.Point(0,0),n<0&&(n=0),o<0&&(o=0),this.init()}return t.prototype.init=function(){this.ex=this.x+this.width,this.ey=this.y+this.height,this.calcCenter()},t.prototype.floor=function(){this.x|=0,this.y|=0,this.width|=0,this.height|=0,this.init()},t.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this.init()},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.hit=function(t,e){return void 0===e&&(e=0),t.x>this.x-e&&t.x<this.ex+e&&t.y>this.y-e&&t.y<this.ey+e},t.prototype.hitByRect=function(rect){return rect.x>this.x&&rect.x<this.ex&&rect.y>this.y&&rect.y<this.ey||rect.ex>this.x&&rect.ex<this.ex&&rect.y>this.y&&rect.y<this.ey||rect.ex>this.x&&rect.ex<this.ex&&rect.ey>this.y&&rect.ey<this.ey||rect.x>this.x&&rect.x<this.ex&&rect.ey>this.y&&rect.ey<this.ey},t.prototype.hitRotate=function(t,e,n){for(var r=this.toPoints(),c=0,h=r;c<h.length;c++){h[c].rotate(e,n)}return o.pointInRect(t,r)},t.prototype.calcCenter=function(){this.center.x=this.x+this.width/2,this.center.y=this.y+this.height/2},t.prototype.toPoints=function(){return[new r.Point(this.x,this.y),new r.Point(this.ex,this.y),new r.Point(this.ex,this.ey),new r.Point(this.x,this.ey)]},t.prototype.translate=function(t,e){this.x+=t,this.y+=e,this.ex+=t,this.ey+=e,this.calcCenter()},t.prototype.scale=function(t,e,n){e||(e=this.center),void 0===n&&(n=t),this.x=e.x-(e.x-this.x)*t,this.y=e.y-(e.y-this.y)*n,this.width*=t,this.height*=n,this.init()},t}();e.Rect=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,o,c){this.x=t,this.y=e,this.direction=n,this.anchorIndex=r,this.id=o,this.hidden=c}return t.prototype.floor=function(){this.x|=0,this.y|=0},t.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y)},t.prototype.clone=function(){var e=new t(this.x,this.y,this.direction,this.anchorIndex,this.id,this.hidden);return this.data&&(e.data=this.data),this.mode&&(e.mode=this.mode),e},t.prototype.hit=function(t,e){return void 0===e&&(e=5),t.x>this.x-e&&t.x<this.x+e&&t.y>this.y-e&&t.y<this.y+e},t.prototype.rotate=function(t,e){if(!t||360===t)return this;t*=Math.PI/180;var n=(this.x-e.x)*Math.cos(t)-(this.y-e.y)*Math.sin(t)+e.x,r=(this.x-e.x)*Math.sin(t)+(this.y-e.y)*Math.cos(t)+e.y;return this.x=n,this.y=r,this},t}();e.Point=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.None=0]="None",t[t.Up=1]="Up",t[t.Right=2]="Right",t[t.Bottom=3]="Bottom",t[t.Left=4]="Left"}(e.Direction||(e.Direction={}))},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(355)),r(n(356)),r(n(340))},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)},function(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var c=n(325),h=n(317),l=n(318),d=n(324),f=n(327),y=n(403),v=n(404),x=n(331),m=n(320),w=n(333),P=n(330);e.images={};var R=function(t){function n(e,r){void 0===r&&(r=!1);var o=t.call(this,e)||this;if(o.is3D=!1,o.zRotate=0,o.imageRatio=!0,o.anchors=[],o.rotatedAnchors=[],o.animateDuration=0,o.animateFrames=[],o.type=c.PenType.Node,o.is3D=e.is3D,o.z=e.z,o.zRotate=e.zRotate||0,o.borderRadius=+e.borderRadius||0,o.borderRadius>1&&(o.borderRadius=1),o.icon=e.icon,o.iconFamily=e.iconFamily,o.iconSize=+e.iconSize,o.iconColor=e.iconColor,o.image=e.image,e.imgNaturalWidth&&(o.imgNaturalWidth=e.imgNaturalWidth),e.imgNaturalHeight&&(o.imgNaturalHeight=e.imgNaturalHeight),e.imageWidth&&(o.imageWidth=e.imageWidth),e.imageHeight&&(o.imageHeight=e.imageHeight),o.imageRatio=e.imageRatio,o.imageAlign=e.imageAlign||"center",o.bkType=e.bkType,o.gradientFromColor=e.gradientFromColor,o.gradientToColor=e.gradientToColor,o.gradientAngle=e.gradientAngle||0,o.gradientRadius=e.gradientRadius||.01,o.paddingTop=e.paddingTop||0,o.paddingBottom=e.paddingBottom||0,o.paddingLeft=e.paddingLeft||0,o.paddingRight=e.paddingRight||0,e.children&&e.children[0]&&e.children[0].parentRect&&(o.paddingLeft=e.children[0].parentRect.offsetX,o.paddingRight=0,o.paddingTop=e.children[0].parentRect.offsetY,o.paddingBottom=0),e.parentRect&&(o.rectInParent={x:100*e.parentRect.x+"%",y:100*e.parentRect.y+"%",width:100*e.parentRect.width+"%",height:100*e.parentRect.height+"%",marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,rotate:e.parentRect.rotate},o.paddingTop=e.parentRect.marginY,o.paddingBottom=e.parentRect.marginY,o.paddingLeft=e.parentRect.marginX,o.paddingRight=e.parentRect.marginX),e.animateFrames){o.animateFrames=e.animateFrames;for(var h=0,l=o.animateFrames;h<l.length;h++){var d=l[h];d.state.init||(d.state=new n(d.state,!0))}}return e.animateDuration&&(o.animateDuration=e.animateDuration),o.animateType=e.animateType?e.animateType:e.animateDuration?"custom":"",o.animateAlone=e.animateAlone,o.iframe=e.iframe,o.elementId=e.elementId,o.audio=e.audio,o.video=e.video,o.play=e.play,o.nextPlay=e.nextPlay,void 0!==e.elementLoaded&&(o.elementId=null,o.elementLoaded=!1),o.init(),r?o.children=null:o.setChild(e.children),o}return o(n,t),n.cloneState=function(t){var e=new n(t);return delete e.animateFrames,e},n.prototype.init=function(){this.calcAbsPadding(),f.textRectFns[this.name]?f.textRectFns[this.name](this):v.defaultTextRect(this),f.iconRectFns[this.name]?f.iconRectFns[this.name](this):v.defaultIconRect(this),this.calcAnchors(),this.elementRendered=!1,this.addToDiv()},n.prototype.addToDiv=function(){(this.audio||this.video||this.iframe||this.elementId||this.hasGif())&&m.Store.set("LT:addDiv",this)},n.prototype.hasGif=function(){if(this.gif)return!0;if(this.children)for(var t=0,e=this.children;t<e.length;t++){var n=e[t];if(n.type===c.PenType.Node&&n.hasGif())return!0}return!1},n.prototype.calcAbsPadding=function(){this.paddingLeftNum=w.abs(this.rect.width,this.paddingLeft),this.paddingRightNum=w.abs(this.rect.width,this.paddingRight),this.paddingTopNum=w.abs(this.rect.height,this.paddingTop),this.paddingBottomNum=w.abs(this.rect.height,this.paddingBottom)},n.prototype.setChild=function(t){if(t){this.children=[];for(var e=0,r=t;e<r.length;e++){var o=r[e],h=void 0;switch(o.type){case c.PenType.Line:(h=new d.Line(o)).calcRectByParent(this);break;default:(h=new n(o)).parentId=this.id,h.calcRectByParent(this),h.init(),h.setChild(o.children)}h.id=P.s8(),this.children.push(h)}}},n.prototype.draw=function(t){if(f.drawNodeFns[this.name]){switch(this.bkType){case 1:this.drawBkLinearGradient(t);break;case 2:this.drawBkRadialGradient(t)}f.drawNodeFns[this.name](t,this),"text"!==this.name&&this.text&&x.text(t,this),this.image?this.drawImg(t):this.icon&&(t.save(),t.shadowColor="",t.shadowBlur=0,x.iconfont(t,this),t.restore())}},n.prototype.drawBkLinearGradient=function(t){var e=new l.Point(this.rect.x,this.rect.center.y),n=new l.Point(this.rect.ex,this.rect.center.y);this.gradientAngle%90==0&&this.gradientAngle%180?this.gradientAngle%270?(e.x=this.rect.center.x,e.y=this.rect.y,n.x=this.rect.center.x,n.y=this.rect.ey):(e.x=this.rect.center.x,e.y=this.rect.ey,n.x=this.rect.center.x,n.y=this.rect.y):this.gradientAngle&&(e.rotate(this.gradientAngle,this.rect.center),n.rotate(this.gradientAngle,this.rect.center));var r=t.createLinearGradient(e.x,e.y,n.x,n.y);r.addColorStop(0,this.gradientFromColor),r.addColorStop(1,this.gradientToColor),t.fillStyle=r},n.prototype.drawBkRadialGradient=function(t){var e=this.rect.width;e<this.rect.height&&(e=this.rect.height),e*=.5;var n=t.createRadialGradient(this.rect.center.x,this.rect.center.y,e*this.gradientRadius,this.rect.center.x,this.rect.center.y,e);n.addColorStop(0,this.gradientFromColor),n.addColorStop(1,this.gradientToColor),t.fillStyle=n},n.prototype.drawImg=function(t){var n=this;if(this.lastImage!==this.image&&(this.img=null),this.img){t.save(),t.shadowColor="",t.shadowBlur=0;var rect=this.getIconRect(),r=rect.x,o=rect.y,c=rect.width,h=rect.height;switch(this.imageWidth&&(c=this.imageWidth),this.imageHeight&&(h=this.imageHeight),this.imageRatio&&(this.imageWidth?h=this.imgNaturalHeight/this.imgNaturalWidth*c:c=this.imgNaturalWidth/this.imgNaturalHeight*h),"image"!==this.name&&(r+=(rect.width-c)/2,o+=(rect.height-h)/2),this.imageAlign){case"top":o=rect.y;break;case"bottom":o=rect.ey-h;break;case"left":r=rect.x;break;case"right":r=rect.ex-c;break;case"left-top":r=rect.x,o=rect.y;break;case"right-top":r=rect.ex-c,o=rect.y;break;case"left-bottom":r=rect.x,o=rect.ey-h;break;case"right-bottom":r=rect.ex-c,o=rect.ey-h}return t.drawImage(this.img,r,o,c,h),void t.restore()}var l=this.image.indexOf(".gif")>0;if(!l&&e.images[this.image])return this.img=e.images[this.image].img,++e.images[this.image].cnt,this.lastImage=this.image,this.imgNaturalWidth=this.img.naturalWidth,this.imgNaturalHeight=this.img.naturalHeight,void this.drawImg(t);var img=new Image;img.crossOrigin="anonymous",img.src=this.image,img.onload=function(){n.lastImage=n.image,n.imgNaturalWidth=img.naturalWidth,n.imgNaturalHeight=img.naturalHeight,n.img=img,e.images[n.image]={img:img,cnt:1},m.Store.set("LT:imageLoaded",!0),!n.gif&&l&&(n.gif=!0,m.Store.set("LT:addDiv",n))}},n.prototype.calcAnchors=function(){this.anchors=[],f.anchorsFns[this.name]?f.anchorsFns[this.name](this):y.defaultAnchors(this),this.calcRotateAnchors()},n.prototype.calcRotateAnchors=function(t){void 0===t&&(t=this.rotate),this.rotatedAnchors=[];for(var e=0,n=this.anchors;e<n.length;e++){var r=n[e];this.rotatedAnchors.push(r.clone().rotate(t,this.rect.center))}},n.prototype.getTextRect=function(){var t=this.textRect;return this.icon||this.image||(t=this.fullTextRect),t},n.prototype.getIconRect=function(){var rect=this.iconRect;return this.text||(rect=this.fullIconRect||this.fullTextRect||this.rect),rect},n.prototype.calcRectByParent=function(t){if(this.rectInParent){var e=t.rect.width-t.paddingLeftNum-t.paddingRightNum,n=t.rect.height-t.paddingTopNum-t.paddingBottomNum,r=t.rect.x+t.paddingLeftNum+w.abs(e,this.rectInParent.x)+w.abs(e,this.rectInParent.marginLeft),o=t.rect.y+t.paddingTopNum+w.abs(n,this.rectInParent.y)+w.abs(e,this.rectInParent.marginTop),c=w.abs(e,this.rectInParent.width),l=w.abs(n,this.rectInParent.height);void 0===this.rectInParent.marginLeft&&this.rectInParent.marginRight&&(r-=w.abs(e,this.rectInParent.marginRight)),void 0===this.rectInParent.marginTop&&this.rectInParent.marginBottom&&(o-=w.abs(e,this.rectInParent.marginBottom)),this.rect=new h.Rect(r,o,c,l),this.rectInParent.rotate||(this.rectInParent.rotate=0);var d=t.rotate+t.offsetRotate;this.rotate=this.rectInParent.rotate+d,this.rectInParent.rect||(this.rectInParent.rect=this.rect.clone())}},n.prototype.calcChildrenRect=function(){if(this.children)for(var t=0,e=this.children;t<e.length;t++){var n=e[t];switch(n.type){case c.PenType.Line:n.calcRectByParent(this);break;default:n.calcRectByParent(this),n.init(),n.calcChildrenRect()}}},n.prototype.calcRectInParent=function(t){var e=t.rect.width-t.paddingLeftNum-t.paddingRightNum,n=t.rect.height-t.paddingTopNum-t.paddingBottomNum;this.rectInParent={x:100*(this.rect.x-t.rect.x-t.paddingLeftNum)/e+"%",y:100*(this.rect.y-t.rect.y-t.paddingTopNum)/n+"%",width:100*this.rect.width/e+"%",height:100*this.rect.height/n+"%",rotate:this.rotate,rect:this.rect.clone()}},n.prototype.getDockWatchers=function(){this.dockWatchers=this.rect.toPoints(),this.dockWatchers.unshift(this.rect.center)},n.prototype.initAnimateProps=function(){for(var t=0,i=0;i<this.animateFrames.length;++i)this.animateFrames[i].start=t,t+=this.animateFrames[i].duration,this.animateFrames[i].end=t,this.animateFrames[i].initState=n.cloneState(i?this.animateFrames[i-1].state:this)},n.prototype.animate=function(t){var e=t-this.animateStart;if(e>this.animateDuration){if(++this.animateCycleIndex>=this.animateCycle&&this.animateCycle>0){this.animateStart=0,this.animateCycleIndex=0;var n=this.animateFrames[this.animateFrames.length-1];return this.dash=n.state.dash,this.strokeStyle=n.state.strokeStyle,this.fillStyle=n.state.fillStyle,this.font=n.state.font,this.lineWidth=n.state.lineWidth,this.rotate=n.state.rotate,this.globalAlpha=n.state.globalAlpha,this.lineDashOffset=n.state.lineDashOffset||0,n.state.rect&&n.state.rect.width&&(this.rect=new h.Rect(n.state.rect.x,n.state.rect.y,n.state.rect.width,n.state.rect.height),this.init()),m.Store.set("animateEnd",{type:"node",data:this}),this.nextAnimate}this.animateStart=t,e=0}for(var r=!1,i=0;i<this.animateFrames.length;++i){if(e>=(n=this.animateFrames[i]).start&&e<n.end){this.dash=n.state.dash,this.strokeStyle=n.state.strokeStyle,this.fillStyle=n.state.fillStyle,this.font=n.state.font;var o=(e-n.start)/n.duration;n.linear?(n.state.rect.x!==n.initState.rect.x&&(this.rect.x=n.initState.rect.x+(n.state.rect.x-n.initState.rect.x)*o,r=!0),n.state.rect.y!==n.initState.rect.y&&(this.rect.y=n.initState.rect.y+(n.state.rect.y-n.initState.rect.y)*o,r=!0),n.state.rect.width!==n.initState.rect.width&&(this.rect.width=n.initState.rect.width+(n.state.rect.width-n.initState.rect.width)*o,r=!0),n.state.rect.height!==n.initState.rect.height&&(this.rect.height=n.initState.rect.height+(n.state.rect.height-n.initState.rect.height)*o,r=!0),this.rect.ex=this.rect.x+this.rect.width,this.rect.ey=this.rect.y+this.rect.height,this.rect.calcCenter(),void 0!==n.initState.z&&n.state.z!==n.initState.z&&(this.z=n.initState.z+(n.state.z-n.initState.z)*o,r=!0),n.state.borderRadius!==n.initState.borderRadius&&(this.borderRadius=n.initState.borderRadius+(n.state.borderRadius-n.initState.borderRadius)*o),n.state.lineWidth!==n.initState.lineWidth&&(this.lineWidth=n.initState.lineWidth+(n.state.lineWidth-n.initState.lineWidth)*o),n.state.rotate!==n.initState.rotate&&(this.rotate=n.initState.rotate+(n.state.rotate-n.initState.rotate)*o,r=!0),n.state.globalAlpha!==n.initState.globalAlpha&&(this.globalAlpha=n.initState.globalAlpha+(n.state.globalAlpha-n.initState.globalAlpha)*o),n.state.lineDashOffset&&(this.lineDashOffset?this.lineDashOffset+=n.state.lineDashOffset:this.lineDashOffset=n.state.lineDashOffset)):(this.rect=n.state.rect,this.lineWidth=n.state.lineWidth,this.rotate=n.state.rotate,this.globalAlpha=n.state.globalAlpha,this.lineDashOffset=n.state.lineDashOffset)}}return r&&(this.init(),this.animateAlone||m.Store.set("LT:rectChanged",this)),""},n.prototype.scale=function(t,e){if(e||(e=this.rect.center),this.rect.x=e.x-(e.x-this.rect.x)*t,this.rect.y=e.y-(e.y-this.rect.y)*t,this.z*=t,this.rect.width*=t,this.rect.height*=t,this.rect.ex=this.rect.x+this.rect.width,this.rect.ey=this.rect.y+this.rect.height,this.imageWidth&&(this.imageWidth*=t),this.imageHeight&&(this.imageHeight*=t),this.font.fontSize*=t,this.iconSize*=t,this.rect.calcCenter(),this.animateFrames)for(var r=0,o=this.animateFrames;r<o.length;r++){(l=o[r]).state&&(l.state=new n(l.state),l.state.scale(t,e))}if(this.elementRendered=!1,this.init(),this.children)for(var c=0,h=this.children;c<h.length;c++){var l;(l=h[c]).scale(t,e)}},n.prototype.translate=function(t,e){if(this.rect.x+=t,this.rect.y+=e,this.rect.ex=this.rect.x+this.rect.width,this.rect.ey=this.rect.y+this.rect.height,this.rect.calcCenter(),this.animateFrames)for(var n=0,r=this.animateFrames;n<r.length;n++){var o=r[n];o.state&&(o.state.rect.x+=t,o.state.rect.y+=e,o.state.rect.ex=o.state.rect.x+o.state.rect.width,o.state.rect.ey=o.state.rect.y+o.state.rect.height)}if(this.init(),this.children)for(var c=0,h=this.children;c<h.length;c++){h[c].translate(t,e)}},n.prototype.initRect=function(){if(this.rect.init(),this.children){this.calcChildrenRect();for(var t=0,e=this.children;t<e.length;t++){var r=e[t];r instanceof n&&r.initRect()}}},n.prototype.round=function(){if(this.rect.round(),this.children)for(var t=0,e=this.children;t<e.length;t++){e[t].rect.round()}},n.prototype.clone=function(){return new n(this)},n}(c.Pen);e.Node=R},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,o){this.x=t,this.y=e,this.x=this.x<<0,this.y=this.y<<0,this.direction=n,this.anchorIndex=r,this.id=o}return t.prototype.clone=function(){return new t(this.x,this.y,this.direction,this.anchorIndex,this.id)},t.prototype.hit=function(t,e){return void 0===e&&(e=5),t.x>this.x-e&&t.x<this.x+e&&t.y>this.y-e&&t.y<this.y+e},t.prototype.rotate=function(t,e){if(!t||360===t)return this;t*=Math.PI/180;var n=(this.x-e.x)*Math.cos(t)-(this.y-e.y)*Math.sin(t)+e.x,r=(this.x-e.x)*Math.sin(t)+(this.y-e.y)*Math.cos(t)+e.y;return this.x=n,this.y=r,this},t}();e.Point=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322),o=n(419),c=function(){function t(t,e,n,o){this.x=t,this.y=e,this.width=n,this.height=o,this.center=new r.Point(0,0),this.x=this.x<<0,this.y=this.y<<0,this.width=this.width<<0,this.height=this.height<<0,this.ex=this.x+this.width,this.ey=this.y+this.height,this.calceCenter()}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.hit=function(t,e){return void 0===e&&(e=0),t.x>this.x-e&&t.x<this.ex+e&&t.y>this.y-e&&t.y<this.ey+e},t.prototype.hitRect=function(rect){return rect.x>this.x&&rect.x<this.ex&&rect.y>this.y&&rect.y<this.ey||rect.ex>this.x&&rect.ex<this.ex&&rect.y>this.y&&rect.y<this.ey||rect.ex>this.x&&rect.ex<this.ex&&rect.ey>this.y&&rect.ey<this.ey||rect.x>this.x&&rect.x<this.ex&&rect.ey>this.y&&rect.ey<this.ey},t.prototype.hitRotate=function(t,e,n){for(var r=this.toPoints(),c=0,h=r;c<h.length;c++){h[c].rotate(e,n)}return o.pointInRect(t,r)},t.prototype.calceCenter=function(){this.center.x=this.x+this.width/2<<0,this.center.y=this.y+this.height/2<<0},t.prototype.toPoints=function(){return[new r.Point(this.x,this.y),new r.Point(this.ex,this.y),new r.Point(this.ex,this.ey),new r.Point(this.x,this.ey)]},t}();e.Rect=c},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)},function(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var c=n(325),h=n(318),l=n(327),d=n(332),f=n(320),y=n(326),v=n(331),x=n(317),m=n(333),w=function(t){function e(e){var n=t.call(this,e)||this;if(n.controlPoints=[],n.fromArrowSize=5,n.toArrowSize=5,n.borderWidth=0,n.borderColor="#000000",n.animateColor="",n.animateSpan=1,n.animatePos=0,n.isAnimate=!1,n.animateFromSize=0,n.animateToSize=0,n.animateDotSize=3,n.type=c.PenType.Line,e){if(e.from&&(n.from=new h.Point(e.from.x,e.from.y,e.from.direction,e.from.anchorIndex,e.from.id)),e.to&&(n.to=new h.Point(e.to.x,e.to.y,e.to.direction,e.to.anchorIndex,e.to.id)),e.controlPoints)for(var r=0,o=e.controlPoints;r<o.length;r++){var l=o[r];n.controlPoints.push(new h.Point(l.x,l.y,l.direction,l.anchorIndex,l.id))}n.fromArrow=e.fromArrow||"",n.toArrow=e.toArrow||"",n.fromArrowSize=e.fromArrowSize||5,n.toArrowSize=e.toArrowSize||5,n.fromArrowColor=e.fromArrowColor,n.toArrowColor=e.toArrowColor,e.animateColor&&(n.animateColor=e.animateColor),e.animateSpan&&(n.animateSpan=e.animateSpan),e.length&&(n.length=e.length),e.borderWidth&&(n.borderColor=e.borderColor,n.borderWidth=e.borderWidth),n.animateDotSize=e.animateDotSize||3,n.manualCps=!!e.manualCps}else n.name="curve",n.fromArrow="triangleSolid";var data=f.Store.get("topology-data");return n.font.background||(n.font.background=data.bkColor||"#fff"),n}return o(e,t),e.prototype.setFrom=function(t,e){void 0===e&&(e=""),this.from=t,this.fromArrow=e,this.textRect=null},e.prototype.setTo=function(t,e){void 0===e&&(e="triangleSolid"),this.to=t,this.toArrow=e,this.textRect=null},e.prototype.calcControlPoints=function(t){this.manualCps&&!t||(this.textRect=null,this.from&&this.to&&l.drawLineFns[this.name]&&l.drawLineFns[this.name].controlPointsFn(this))},e.prototype.draw=function(t){if(this.animateDot){if(t.fillStyle=this.strokeStyle,"dot"===this.animateType)return t.beginPath(),t.arc(this.animateDot.x,this.animateDot.y,this.animateDotSize,0,2*Math.PI,!1),void t.fill();if("comet"===this.animateType){var e=this.getBubbles();t.save();for(var n=0,r=e;n<r.length;n++){var o=r[n];t.globalAlpha=o.a,t.beginPath(),t.arc(o.pos.x,o.pos.y,o.r,0,2*Math.PI,!1),t.fill()}t.restore()}}!this.isAnimate&&this.borderWidth>0&&this.borderColor&&(t.save(),t.lineWidth=this.lineWidth+this.borderWidth,t.strokeStyle=this.borderColor,l.drawLineFns[this.name]&&l.drawLineFns[this.name].drawFn(t,this),t.restore()),this.isAnimate&&"comet"===this.animateType||!l.drawLineFns[this.name]||l.drawLineFns[this.name].drawFn(t,this);var c=f.Store.get("LT:scale")||1;if(this.fromArrow&&l.drawArrowFns[this.fromArrow]){t.save(),t.beginPath(),t.lineDashOffset=0,t.setLineDash([]),t.fillStyle=this.fromArrowColor||this.strokeStyle||t.strokeStyle,t.strokeStyle=t.fillStyle;var h=this.to;"curve"===this.name?h=d.getBezierPoint(.95-this.lineWidth/100,this.to,this.controlPoints[1],this.controlPoints[0],this.from):"line"!==this.name&&this.controlPoints.length&&(h=this.controlPoints[0]),l.drawArrowFns[this.fromArrow](t,h,this.from,this.fromArrowSize*c),t.restore()}if(this.toArrow&&l.drawArrowFns[this.toArrow]){t.save(),t.beginPath(),t.lineDashOffset=0,t.setLineDash([]),t.fillStyle=this.toArrowColor||this.strokeStyle||t.strokeStyle,t.strokeStyle=t.fillStyle;h=this.from;"curve"===this.name?h=d.getBezierPoint(.95-this.lineWidth/100,this.from,this.controlPoints[0],this.controlPoints[1],this.to):"line"!==this.name&&this.controlPoints.length&&(h=this.controlPoints[this.controlPoints.length-1]),l.drawArrowFns[this.toArrow](t,h,this.to,this.toArrowSize*c),t.restore()}this.text&&!this.isAnimate&&(this.textRect||this.calcTextRect(),v.text(t,this))},e.prototype.pointIn=function(t){return l.drawLineFns[this.name].pointIn(t,this)},e.prototype.getLen=function(){switch(this.name){case"line":return y.lineLen(this.from,this.to);case"polyline":if(!this.controlPoints||!this.controlPoints.length)return y.lineLen(this.from,this.to);for(var t=0,e=this.from,n=0,r=this.controlPoints;n<r.length;n++){var o=r[n];t+=y.lineLen(e,o),e=o}return 0|(t+=y.lineLen(e,this.to));case"curve":return y.curveLen(this.from,this.controlPoints[0],this.controlPoints[1],this.to)}return 0},e.prototype.calcTextRect=function(){var t=this.getCenter(),e=Math.abs(this.from.x-this.to.x);e<100&&(e=100);var n=this.font.lineHeight*this.font.fontSize*(this.textMaxLine||1);this.textRect=new x.Rect(t.x-e/2,t.y-n/2,e,n)},e.prototype.getTextRect=function(){return this.textRect||this.calcTextRect(),this.textRect},e.prototype.getCenter=function(){var t=new h.Point(this.from.x,this.from.y);switch(this.name){case"line":t=this.getLineCenter(this.from,this.to);break;case"polyline":var i=Math.floor(this.controlPoints.length/2);t=this.getLineCenter(this.controlPoints[i-1],this.controlPoints[i]);break;case"curve":t=d.getBezierPoint(.5,this.to,this.controlPoints[1],this.controlPoints[0],this.from)}return t},e.prototype.getLineCenter=function(t,e){return new h.Point((t.x+e.x)/2,(t.y+e.y)/2)},e.prototype.getPointByPos=function(t){if(t<=0)return this.from;switch(this.name){case"line":return this.getLinePtByPos(this.from,this.to,t);case"polyline":if(this.controlPoints&&this.controlPoints.length){for(var e=[].concat(this.controlPoints,this.to),n=this.from,r=0,o=e;r<o.length;r++){var c=o[r],h=y.lineLen(n,c);if(!(t>h))return this.getLinePtByPos(n,c,t);t-=h,n=c}return this.to}return this.getLinePtByPos(this.from,this.to,t);case"curve":return d.getBezierPoint(t/this.getLen(),this.from,this.controlPoints[0],this.controlPoints[1],this.to)}return null},e.prototype.getLinePtByPos=function(t,e,n){var r,o,c=y.lineLen(t,e);return n<=0?t:n>=c?e:(r=t.x+(e.x-t.x)*(n/c),o=t.y+(e.y-t.y)*(n/c),new h.Point(r,o))},e.prototype.calcRectInParent=function(t){var e=t.rect.width-t.paddingLeftNum-t.paddingRightNum,n=t.rect.height-t.paddingTopNum-t.paddingBottomNum;this.rectInParent={x:100*(this.from.x-t.rect.x-t.paddingLeftNum)/e+"%",y:100*(this.from.y-t.rect.y-t.paddingTopNum)/n+"%",width:0,height:0,rotate:0}},e.prototype.calcRectByParent=function(t){if(this.rectInParent){var e=t.rect.width-t.paddingLeftNum-t.paddingRightNum,n=t.rect.height-t.paddingTopNum-t.paddingBottomNum,r=t.rect.x+t.paddingLeftNum+m.abs(e,this.rectInParent.x)+m.abs(e,this.rectInParent.marginLeft),o=t.rect.y+t.paddingTopNum+m.abs(n,this.rectInParent.y)+m.abs(e,this.rectInParent.marginTop);void 0===this.rectInParent.marginLeft&&this.rectInParent.marginRight&&(r-=m.abs(e,this.rectInParent.marginRight)),void 0===this.rectInParent.marginTop&&this.rectInParent.marginBottom&&(o-=m.abs(e,this.rectInParent.marginBottom)),this.translate(r-this.from.x,o-this.from.y)}},e.prototype.animate=function(t){switch(this.animateFromSize&&(this.lineDashOffset=-this.animateFromSize),this.animatePos+=this.animateSpan,this.animateDot=null,this.animateType){case"beads":this.lineDashOffset=-this.animatePos;var e=this.lineWidth;e<5&&(e=5),this.lineDash=[e,2*e];break;case"dot":case"comet":this.lineDash=null,this.animateDot=this.getPointByPos(this.animatePos+this.animateFromSize);break;default:this.lineDash=[this.animatePos,this.length-this.animatePos+1]}if(this.animatePos>this.length+this.animateSpan-this.animateFromSize-this.animateToSize){if(++this.animateCycleIndex>=this.animateCycle&&this.animateCycle>0)return this.animateStart=0,f.Store.set("animateEnd",{type:"line",data:this}),this.nextAnimate;this.animatePos=this.animateSpan}return""},e.prototype.getBubbles=function(){for(var t=[],i=0;i<30&&this.animatePos-i>0;++i)t.push({pos:this.getPointByPos(this.animatePos-2*i+this.animateFromSize),a:1-.03*i,r:this.lineWidth-.01*i});return t},e.prototype.round=function(){this.from.round(),this.to.round()},e.prototype.translate=function(t,e){this.from.x+=t,this.from.y+=e,this.to.x+=t,this.to.y+=e,this.text&&(this.textRect=null);for(var n=0,r=this.controlPoints;n<r.length;n++){var o=r[n];o.x+=t,o.y+=e}f.Store.set("pts-"+this.id,null)},e.prototype.scale=function(t,e){this.from.x=e.x-(e.x-this.from.x)*t,this.from.y=e.y-(e.y-this.from.y)*t,this.to.x=e.x-(e.x-this.to.x)*t,this.to.y=e.y-(e.y-this.to.y)*t,this.text&&this.font&&this.font.fontSize&&(this.font.fontSize*=t,this.textRect=null);for(var n=0,r=this.controlPoints;n<r.length;n++){var o=r[n];o.x=e.x-(e.x-o.x)*t,o.y=e.y-(e.y-o.y)*t}f.Store.set("pts-"+this.id,null)},e.prototype.clone=function(){return new e(this)},e}(c.Pen);e.Line=w},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(320),c=n(330),h=n(317),l=n(326),d=n(342);!function(t){t[t.Node=0]="Node",t[t.Line=1]="Line"}(r=e.PenType||(e.PenType={}));var f=function(){function t(t){this.id="",this.type=r.Node,this.name="",this.tags=[],this.rect=new h.Rect(0,0,0,0),this.lineWidth=1,this.rotate=0,this.offsetRotate=0,this.globalAlpha=1,this.dash=0,this.strokeStyle="",this.fillStyle="",this.font={color:"",fontFamily:'"Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial',fontSize:12,lineHeight:1.5,fontStyle:"normal",fontWeight:"normal",textAlign:"center",textBaseline:"middle",background:""},this.animateCycleIndex=0,this.events=[],this.eventFns=["link","doAnimate","doFn","doWindowFn"],t?(this.id=t.id||c.s8(),this.name=t.name||"",this.tags=Object.assign([],t.tags),t.rect&&(this.rect=new h.Rect(t.rect.x,t.rect.y,t.rect.width,t.rect.height)),this.dash=t.dash||0,this.lineDash=t.lineDash,this.lineDashOffset=t.lineDashOffset||0,(t.lineWidth||0===t.lineWidth)&&(this.lineWidth=t.lineWidth),this.strokeStyle=t.strokeStyle||"",this.fillStyle=t.fillStyle||"",this.lineCap=t.lineCap,this.globalAlpha=t.globalAlpha||1,this.rotate=t.rotate||0,this.offsetRotate=t.offsetRotate||0,t.font&&Object.assign(this.font,t.font),this.text=t.text,t.textMaxLine&&(this.textMaxLine=+t.textMaxLine||0),this.textOffsetX=t.textOffsetX||0,this.textOffsetY=t.textOffsetY||0,this.shadowColor=t.shadowColor,this.shadowBlur=t.shadowBlur,this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.animateType=t.animateType,this.animateCycle=t.animateCycle,this.nextAnimate=t.nextAnimate,this.animatePlay=t.animatePlay,this.locked=t.locked,this.stand=t.stand,this.hideInput=t.hideInput,this.hideRotateCP=t.hideRotateCP,this.hideSizeCP=t.hideSizeCP,this.hideAnchor=t.hideAnchor,this.events=t.events||[],this.markdown=t.markdown,this.tipId=t.tipId,this.title=t.title,t.rectInParent&&(this.rectInParent=t.rectInParent),"object"==typeof t.data?this.data=JSON.parse(JSON.stringify(t.data)):this.data=t.data||""):(this.id=c.s8(),this.textOffsetX=0,this.textOffsetY=0)}return t.prototype.render=function(t){if(!this.from||this.to){if(t.save(),(this.rotate||this.offsetRotate)&&(t.translate(this.rect.center.x,this.rect.center.y),t.rotate((this.rotate+this.offsetRotate)*Math.PI/180),t.translate(-this.rect.center.x,-this.rect.center.y)),this.lineWidth>1&&(t.lineWidth=this.lineWidth),t.strokeStyle=this.strokeStyle||"#222",t.fillStyle=this.fillStyle||"transparent",this.lineCap&&(t.lineCap=this.lineCap),this.globalAlpha<1&&(t.globalAlpha=this.globalAlpha),this.lineDash)t.setLineDash(this.lineDash);else switch(this.dash){case 1:t.setLineDash([5,5]);break;case 2:t.setLineDash([10,10]);break;case 3:t.setLineDash([10,10,2,10])}if(this.lineDashOffset&&(t.lineDashOffset=this.lineDashOffset),this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY,t.shadowBlur=this.shadowBlur),this.draw(t),t.restore(),this.children)for(var e=0,n=this.children;e<n.length;e++){n[e].render(t)}}},t.prototype.hit=function(t,e){if(void 0===e&&(e=0),this.rotate%360==0)return this.rect.hit(t,e);for(var n=this.rect.toPoints(),r=0,o=n;r<o.length;r++){o[r].rotate(this.rotate,this.rect.center)}return l.pointInRect(t,n)},t.prototype.click=function(){if(this.events)for(var t=0,e=this.events;t<e.length;t++){var n=e[t];n.type===d.EventType.Click&&(this[this.eventFns[n.action]]&&this[this.eventFns[n.action]](n.value,n.params))}},t.prototype.dblclick=function(){if(this.events)for(var t=0,e=this.events;t<e.length;t++){var n=e[t];n.type===d.EventType.DblClick&&(this[this.eventFns[n.action]]&&this[this.eventFns[n.action]](n.value,n.params))}},t.prototype.doSocket=function(t,e,n){t.action<d.EventAction.Function?this[this.eventFns[event.type]](e.value||e||t.value,e.params||t.params,n):this[this.eventFns[event.type]](t.value,e||t.params,n)},t.prototype.link=function(t,e){window.open(t,"_blank")},t.prototype.doAnimate=function(t,e){this.animateStart=Date.now(),o.Store.set("LT:AnimatePlay",{tag:t,pen:this})},t.prototype.doFn=function(t,e,n){(n?new Function("pen","params","websocket",t):new Function("pen","params",t))(this,e,n)},t.prototype.doWindowFn=function(t,e,n){window[t](this,e,n)},t}();e.Pen=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318);function o(t,e){if(e.length<3)return!1;for(var n=!1,r=e[e.length-1],o=0,c=e;o<c.length;o++){var h=c[o];(h.y<t.y&&r.y>=t.y||h.y>=t.y&&r.y<t.y)&&h.x+(t.y-h.y)*(r.x-h.x)/(r.y-h.y)>t.x&&(n=!n),r=h}return n}e.pointInRect=o,e.pointInLine=function(t,e,n){return o(t,[new r.Point(e.x-8,e.y-8),new r.Point(n.x-8,n.y-8),new r.Point(n.x+8,n.y+8),new r.Point(e.x+8,e.y+8)])},e.lineLen=function(t,e){return 0|Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2))},e.curveLen=function(t,e,n,r){var path=document.createElementNS("http://www.w3.org/2000/svg","path");return path.setAttribute("d","M"+t.x+" "+t.y+" C"+e.x+" "+e.y+" "+n.x+" "+n.y+" "+r.x+" "+r.y),0|path.getTotalLength()}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(358)),r(n(344))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Up=1]="Up",t[t.Right=2]="Right",t[t.Bottom=3]="Bottom",t[t.Left=4]="Left"}(e.Direction||(e.Direction={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.None=0]="None",t[t.Readonly=1]="Readonly",t[t.NoEvent=2]="NoEvent"}(e.Lock||(e.Lock={})),function(t){t[t.Default=0]="Default",t[t.In=1]="In",t[t.Out=2]="Out"}(e.AnchorMode||(e.AnchorMode={}))},function(t,e,n){"use strict";function r(){return(65536*(1+Math.random())|0).toString(16).substring(1)}Object.defineProperty(e,"__esModule",{value:!0}),e.s4=r,e.s8=function(){return r()+r()},e.s12=function(){return r()+r()+r()},e.s16=function(){return r()+r()+r()+r()}},function(t,e,n){"use strict";function r(t){var e=[],n="";t||(t="");for(var i=0;i<t.length;++i){var r=t.charCodeAt(i);r<33||r>126?(n&&(e.push(n),n=""),e.push(t[i])):n+=t[i]}return n&&e.push(n),e}function o(t,e,n,r){for(var o=[],c=e[0]||"",i=1;i<e.length;++i){var h=e[i]||"",l=c+h,d=(l.match(/[\u4e00-\u9fa5]/g)||"").length;(l.length-d)*r*.5+d*r<n?c+=h:(o.push(c),c=h)}return o.push(c),o}function c(t,e,n,r,o,c){if(e&&c){var h=t.measureText(e).width;t.save(),t.fillStyle=c;var l=n-h/2,d=r-o/2;switch(t.textAlign){case"left":l=n;break;case"right":l=n-h}switch(t.textBaseline){case"top":d=r;break;case"bottom":d=r-o}t.fillRect(l,d,h,o),t.restore()}}function h(t,e,n,r,o,h,l,d,f){d=!d||d>e.length?e.length:Math.ceil(d);for(var i=0;i<d-1;++i)f&&c(t,e[i],n,r+i*l,l,f),t.fillText(e[i],n,r+i*l);if(d<e.length){var y=(e[d-1]||"")+"...";e[d-1]&&t.measureText(y).width>o&&(y=e[d-1].substr(0,e[d-1].length-2)+"..."),f&&c(t,y,n,r+(d-1)*l,l,f),t.fillText(y,n,r+(d-1)*l)}else f&&c(t,e[d-1],n,r+(d-1)*l,l,f),t.fillText(e[d-1],n,r+(d-1)*l)}Object.defineProperty(e,"__esModule",{value:!0}),e.getWords=r,e.getLines=o,e.fillText=h,e.text=function(t,e){if(e.text){t.save(),t.beginPath(),delete t.shadowColor,delete t.shadowBlur,t.font=(e.font.fontStyle||"normal")+" normal "+(e.font.fontWeight||"normal")+" "+e.font.fontSize+"px/"+e.font.lineHeight+" "+e.font.fontFamily,e.font.color?t.fillStyle=e.font.color:t.fillStyle="#222",e.font.textAlign&&(t.textAlign=e.font.textAlign),e.font.textBaseline&&(t.textBaseline=e.font.textBaseline);for(var n=e.getTextRect(),c=[],l=e.text.split(/[\n,]/g),i=0;i<l.length;++i){var d=o(0,r(l[i]),n.width,e.font.fontSize);c.push.apply(c,d)}var f=e.font.fontSize*e.font.lineHeight,y=e.textMaxLine,v=n.height/f;y||(y=c.length>v?v:c.length);var x=n.x+n.width/2,m=n.y+(n.height-f*y)/2+4*f/7;switch(t.textAlign){case"left":x=n.x;break;case"right":x=n.x+n.width}switch(t.textBaseline){case"top":m=n.y+(f-e.font.fontSize)/2;break;case"bottom":m=n.ey-f*c.length+f}h(t,c,x+e.textOffsetX,m+e.textOffsetY,n.width,n.height,f,y,e.font.background),t.restore()}},e.iconfont=function(t,e){t.save(),t.textAlign="center",t.textBaseline="middle";var n=e.getIconRect(),r=n.x+n.width/2,o=n.y+n.height/2;switch(e.imageAlign){case"top":o=n.y,t.textBaseline="top";break;case"bottom":o=n.ey,t.textBaseline="bottom";break;case"left":r=n.x,t.textAlign="left";break;case"right":r=n.ex,t.textAlign="right";break;case"left-top":r=n.x,o=n.y,t.textAlign="left",t.textBaseline="top";break;case"right-top":r=n.ex,o=n.y,t.textAlign="right",t.textBaseline="top";break;case"left-bottom":r=n.x,o=n.ey,t.textAlign="left",t.textBaseline="bottom";break;case"right-bottom":r=n.ex,o=n.ey,t.textAlign="right",t.textBaseline="bottom"}e.iconSize>0?t.font=e.iconSize+"px "+e.iconFamily:n.width>n.height?t.font=n.height+"px "+e.iconFamily:t.font=n.width+"px "+e.iconFamily,e.iconColor||(e.iconColor="#2f54eb"),t.fillStyle=e.iconColor,t.beginPath(),t.fillText(e.icon,r,o),t.restore()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319),c=n(320),h=n(326);function l(t,e,n,o,c){var h=e.x,l=e.y,d=c.x,f=c.y,y=n.x,v=n.y,x=h*(1-t)*(1-t)*(1-t)+3*y*t*(1-t)*(1-t)+3*o.x*t*t*(1-t)+d*t*t*t,m=l*(1-t)*(1-t)*(1-t)+3*v*t*(1-t)*(1-t)+3*o.y*t*t*(1-t)+f*t*t*t;return new r.Point(x,m)}function d(t,e){var n=new r.Point(t.x,t.y,t.direction,t.anchorIndex,t.id),c=80;if((t.direction===o.Direction.Up||t.direction===o.Direction.Bottom)&&Math.abs(t.x-e.x)<3)return e.y>t.y?(c=Math.floor((e.y-t.y)/3),n.y+=c):(c=Math.floor((t.y-e.y)/3),n.y-=c),n;if((t.direction===o.Direction.Left||t.direction===o.Direction.Right)&&Math.abs(t.y-e.y)<3)return e.x>t.x?(c=Math.floor((e.x-t.x)/3),n.x+=c):(c=Math.floor((t.x-e.x)/3),n.x-=c),n;switch(t.direction){case o.Direction.Up:n.y-=c;break;case o.Direction.Right:n.x+=c;break;case o.Direction.Bottom:n.y+=c;break;case o.Direction.Left:n.x-=c}return n}e.curve=function(t,e){t.beginPath(),t.moveTo(e.from.x,e.from.y),t.bezierCurveTo(e.controlPoints[0].x,e.controlPoints[0].y,e.controlPoints[1].x,e.controlPoints[1].y,e.to.x,e.to.y),t.stroke()},e.curveControlPoints=function(t,e){t.save(),t.fillStyle=t.strokeStyle+"80",t.lineWidth=1,t.beginPath(),t.moveTo(e.from.x,e.from.y),t.lineTo(e.controlPoints[0].x,e.controlPoints[0].y),t.stroke(),t.beginPath(),t.moveTo(e.to.x,e.to.y),t.lineTo(e.controlPoints[1].x,e.controlPoints[1].y),t.stroke(),t.fillStyle="#fff",t.lineWidth=2;for(var n=0,r=e.controlPoints;n<r.length;n++){var o=r[n];t.beginPath(),t.arc(o.x,o.y,4,0,2*Math.PI),t.stroke(),t.fill()}t.restore()},e.calcCurveControlPoints=function(t){t.from.direction||(t.from.direction=o.Direction.Bottom),t.to.direction||(t.to.direction=(t.from.direction+2)%4,t.to.direction||(t.to.direction=o.Direction.Left)),t.controlPoints=[d(t.from,t.to),d(t.to,t.from)],c.Store.set("pts-"+t.id,null)},e.pointInCurve=function(t,e){var n=c.Store.get("pts-"+e.id);if(!n){n=[e.from];for(var i=.01;i<1;i+=.01)n.push(l(i,e.from,e.controlPoints[0],e.controlPoints[1],e.to));n.push(e.to),c.Store.set("pts-"+e.id,n)}var r=n.length-1;for(i=0;i<r;++i)if(h.pointInLine(t,n[i],n[i+1]))return!0;return!1},e.getBezierPoint=l,e.calcMindControlPoints=function(t){var e=t.to.x-t.from.x,n=t.to.y-t.from.y;t.from.direction===o.Direction.Left||t.from.direction===o.Direction.Right?t.controlPoints=[new r.Point(t.from.x,t.from.y+n/2),new r.Point(t.from.x,t.to.y)]:t.controlPoints=[new r.Point(t.from.x+e/2,t.from.y),new r.Point(t.to.x,t.from.y)],c.Store.set("pts-"+t.id,null)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pSBC=function(p,t,e,n){var r,g,b,o,c,h,l,a="string"==typeof e,i=parseInt,d=Math.round;if("number"!=typeof p||p<-1||p>1||"string"!=typeof t||"r"!==t[0]&&"#"!==t[0]||e&&!a)return null;var f=function(t){var e,n=t.length,o={};if(n>9){if(e=t=t.split(","),r=e[0],g=e[1],b=e[2],a=e[3],(n=t.length)<3||n>4)return null;o.r=i("a"===r[3]?r.slice(5):r.slice(4)),o.g=i(g),o.b=i(b),o.a=a?parseFloat(a):-1}else{if(8===n||6===n||n<4)return null;n<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(n>4?t[4]+t[4]:"")),t=i(t.slice(1),16),9===n||5===n?(o.r=t>>24&255,o.g=t>>16&255,o.b=t>>8&255,o.a=d((255&t)/.255)/1e3):(o.r=t>>16,o.g=t>>8&255,o.b=255&t,o.a=-1)}return o};return l=t.length>9,l=a?e.length>9||"c"===e&&!l:l,c=f(t),o=p<0,h=e&&"c"!==e?f(e):o?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},o=1-(p=o?-1*p:p),c&&h?(n?(r=d(o*c.r+p*h.r),g=d(o*c.g+p*h.g),b=d(o*c.b+p*h.b)):(r=d(Math.pow(o*Math.pow(c.r,2)+p*Math.pow(h.r,2),.5)),g=d(Math.pow(o*Math.pow(c.g,2)+p*Math.pow(h.g,2),.5)),b=d(Math.pow(o*Math.pow(c.b,2)+p*Math.pow(h.b,2),.5))),a=c.a,h=h.a,a=(c=a>=0||h>=0)?a<0?h:h<0?a:a*o+h*p:0,l?"rgb"+(c?"a(":"(")+r+","+g+","+b+(c?","+d(1e3*a)/1e3:"")+")":"#"+(4294967296+16777216*r+65536*g+256*b+(c?d(255*a):0)).toString(16).slice(1,c?void 0:-2)):null},e.abs=function(t,e){return+e?+e:e&&"%"===e[e.length-1]?t*+(e=e.substr(0,e.length-1))/100:0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(320);e.createDiv=function(t){var div=document.createElement("div");return div.style.position="absolute",div.style.outline="none",div.style.left="-9999px",div.style.bottom="-9999px",div.style.width=t.rect.width+"px",div.style.height=t.rect.height+"2px",t.elementId&&(div.id=t.elementId),div},e.loadJS=function(t,e,n){var o=document.createElement("script");o.type="text/javascript",o.src=t,o.addEventListener("load",(function(){e&&e(),n&&r.Store.set("LT:render",!0)})),document.body.appendChild(o)}},,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.data={},e.observers={}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(339),o=function(){function t(t,e,n){this.key="",this.id=t,this.key=e,this.fn=n}return t.prototype.unsubscribe=function(){delete r.observers[this.id]},t}();e.Observer=o},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.None=-1]="None",t[t.CtrlOrAlt=0]="CtrlOrAlt",t[t.Ctrl=1]="Ctrl",t[t.Shift=2]="Shift",t[t.Alt=3]="Alt"}(e.KeyType||(e.KeyType={})),function(t){t[t.None=-1]="None",t[t.Document=0]="Document",t[t.Canvas=1]="Canvas"}(r=e.KeydownType||(e.KeydownType={})),e.DefalutOptions={cacheLen:30,font:{color:"#222",fontFamily:'"Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial',fontSize:12,lineHeight:1.5,textAlign:"center",textBaseline:"middle"},color:"#222",hoverColor:"#fa541c",dragColor:"#1890ff",activeColor:"#1890ff",rotateCursor:"/assets/img/rotate.cur",minScale:.25,maxScale:5,keydown:r.Document}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Click=0]="Click",t[t.DblClick=1]="DblClick",t[t.WebSocket=2]="WebSocket"}(e.EventType||(e.EventType={})),function(t){t[t.Link=0]="Link",t[t.Animate=1]="Animate",t[t.Function=2]="Function",t[t.WindowFn=3]="WindowFn"}(e.EventAction||(e.EventAction={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.rectangle=function(t,e){var n=e.rect.width*e.borderRadius,hr=e.rect.height*e.borderRadius,r=n<hr?n:hr;e.rect.width<2*r&&(r=e.rect.width/2),e.rect.height<2*r&&(r=e.rect.height/2),t.beginPath(),t.moveTo(e.rect.x+r,e.rect.y),t.arcTo(e.rect.x+e.rect.width,e.rect.y,e.rect.x+e.rect.width,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height,e.rect.x,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x,e.rect.y+e.rect.height,e.rect.x,e.rect.y,r),t.arcTo(e.rect.x,e.rect.y,e.rect.x+e.rect.width,e.rect.y,r),t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flatNodes=function t(e){for(var n=[],r=0,o=e;r<o.length;r++){var c=o[r];c.type||(n.push(c),c.children&&n.push.apply(n,t(c.children)))}return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(321),o=n(324),c=n(329),h=function(t){if(this.pens=[],this.lineName="curve",this.fromArrowType="",this.toArrowType="triangleSolid",this.scale=1,this.locked=c.Lock.None,t){this.pens=[];for(var e=0,n=t.pens;e<n.length;e++){var h=n[e];h.from?this.pens.push(new o.Line(h)):this.pens.push(new r.Node(h))}this.lineName=t.lineName||"curve",this.fromArrowType=t.fromArrowType||"",this.toArrowType=t.toArrowType||"triangleSolid",this.scale=t.scale||1,this.locked=t.locked||c.Lock.None,this.bkImage=t.bkImage,this.bkColor=t.bkColor,this.grid=t.grid,"object"==typeof t.data?this.data=JSON.parse(JSON.stringify(t.data)):this.data=t.data||""}};e.TopologyData=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(320),o=function(){function t(e,n){void 0===n&&(n={}),this.parentElem=e,this.options=n,this.data=r.Store.get("topology-data"),this.canvas=document.createElement("canvas"),this.width=0,this.height=0,this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.canvas.style.outline="none",t.dpiRatio||(n.extDpiRatio||0===n.extDpiRatio||(window.devicePixelRatio>1?n.extDpiRatio=.25:n.extDpiRatio=0),t.dpiRatio=window.devicePixelRatio+n.extDpiRatio)}return t.prototype.resize=function(e){e?(this.width=0|e.width,this.height=0|e.height):(this.options.width&&"auto"!==this.options.width?this.width=+this.options.width:this.width=this.parentElem.clientWidth,this.options.height&&"auto"!==this.options.height?this.height=+this.options.height:this.height=this.parentElem.clientHeight),this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.canvas.width=this.width*t.dpiRatio|0,this.canvas.height=this.height*t.dpiRatio|0,this.canvas.getContext("2d").scale(t.dpiRatio,t.dpiRatio),r.Store.set("LT:size",{width:this.canvas.width,height:this.canvas.height})},t.prototype.render=function(){this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.getDpiRatio=function(){return t.dpiRatio},t.dpiRatio=0,t}();e.Canvas=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(321),o=n(324),c=n(332),h=n(317);e.getRect=function(t){for(var e=99999,n=99999,l=-99999,d=-99999,f=[],y=0,v=t;y<v.length;y++){if((L=v[y])instanceof r.Node){var x=L.rect.toPoints();if(L.rotate)for(var m=0,w=x;m<w.length;m++){w[m].rotate(L.rotate,L.rect.center)}f.push.apply(f,x)}else if(L instanceof o.Line&&(f.push(L.from),f.push(L.to),"curve"===L.name))for(var i=.01;i<1;i+=.02)f.push(c.getBezierPoint(i,L.from,L.controlPoints[0],L.controlPoints[1],L.to))}for(var P=0,R=f;P<R.length;P++){var L;e>(L=R[P]).x&&(e=L.x),n>L.y&&(n=L.y),l<L.x&&(l=L.x),d<L.y&&(d=L.y)}return new h.Rect(e,n,l-e,d-n)}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(345)),r(n(325)),r(n(321)),r(n(324)),r(n(319)),r(n(318)),r(n(317)),r(n(329)),r(n(342))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n,r,o){this.x=t,this.y=e,this.x=this.x<<0,this.y=this.y<<0,this.direction=n,this.anchorIndex=r,this.id=o}return t.prototype.clone=function(){var e=new t(this.x,this.y,this.direction,this.anchorIndex,this.id);return this.data&&(e.data=this.data),e},t.prototype.hit=function(t,e){return void 0===e&&(e=5),t.x>this.x-e&&t.x<this.x+e&&t.y>this.y-e&&t.y<this.y+e},t.prototype.rotate=function(t,e){if(!t||360===t)return this;t*=Math.PI/180;var n=(this.x-e.x)*Math.cos(t)-(this.y-e.y)*Math.sin(t)+e.x,r=(this.x-e.x)*Math.sin(t)+(this.y-e.y)*Math.cos(t)+e.y;return this.x=n,this.y=r,this},t}();e.Point=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(343),o=n(330),c=n(334),h={};e.echarts=function(t,e){r.rectangle(t,e);var n=window.echarts;e.data&&n&&("string"==typeof e.data&&(e.data=JSON.parse(e.data)),e.data.echarts&&(e.elementId||(e.elementId=o.s8()),e.elementLoaded||(h[e.id]={div:c.createDiv(e)},e.elementLoaded=!0,document.body.appendChild(h[e.id].div),e.addToDiv(),h[e.id].chart=n.init(h[e.id].div,e.data.echarts.theme),e.elementRendered=!1,setTimeout((function(){h[e.id].chart.resize()}))),e.elementRendered||setTimeout((function(){h[e.id].chart.setOption(e.data.echarts.option),h[e.id].chart.resize(),e.elementRendered=!0}))))}},,,function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(354)),r(n(341)),r(n(412)),r(n(348)),r(n(327))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=n(320),c=n(341),h=n(325),l=n(321),d=n(318),f=n(324),y=n(345),v=n(329),x=n(327),m=n(405),w=n(406),P=n(407),R=n(408),L=n(409),T=n(410),k=n(317),I=n(330),M=n(326),S=n(347),_=n(411),A=["nw-resize","ne-resize","se-resize","sw-resize"];!function(t){t[t.None=0]="None",t[t.Line=1]="Line",t[t.LineMove=2]="LineMove",t[t.LineFrom=3]="LineFrom",t[t.LineTo=4]="LineTo",t[t.LineControlPoint=5]="LineControlPoint",t[t.Nodes=6]="Nodes",t[t.ResizeCP=7]="ResizeCP",t[t.HoverAnchors=8]="HoverAnchors",t[t.Rotate=9]="Rotate"}(r||(r={}));var C=function(){function t(t,e){var n=this;this.data=new y.TopologyData,this.caches={index:0,list:[]},this.input=document.createElement("textarea"),this.lastTranlated={x:0,y:0},this.moveIn={type:r.None,activeAnchorIndex:0,hoverAnchorIndex:0,hoverNode:null,hoverLine:null,activeNode:null,lineControlPoint:null},this.needCache=!1,this.tip="",this.scheduledAnimationFrame=!1,this.scrolling=!1,this.winResize=function(){var t;t&&clearTimeout(t),t=setTimeout((function(){n.resize(),n.overflow()}),100)},this.onMouseMove=function(t){if(!n.scheduledAnimationFrame&&n.data.locked!==v.Lock.NoEvent){if(n.mouseDown&&n.moveIn.type===r.None){var b=!1;switch(n.options.translateKey){case c.KeyType.None:b=!0;break;case c.KeyType.Ctrl:t.ctrlKey&&(b=!0);break;case c.KeyType.Shift:t.shiftKey&&(b=!0);break;case c.KeyType.Alt:t.altKey&&(b=!0);break;default:(t.ctrlKey||t.altKey)&&(b=!0)}if(b)return n.translate(t.offsetX-n.mouseDown.x,t.offsetY-n.mouseDown.y,!0),!1}if(!n.data.locked||!n.mouseDown||n.moveIn.type===r.None){n.scheduledAnimationFrame=!0;var e=new d.Point(t.offsetX,t.offsetY);requestAnimationFrame((function(){if(!n.mouseDown)return n.getMoveIn(e),n.moveIn.hoverNode!==n.lastHoverNode&&(n.lastHoverNode&&(n.dispatch("moveOutNode",n.lastHoverNode),n.hideTip(),n.hoverLayer.node=null),n.moveIn.hoverNode&&(n.hoverLayer.node=n.moveIn.hoverNode,n.dispatch("moveInNode",n.moveIn.hoverNode),n.showTip(n.moveIn.hoverNode,e))),n.moveIn.hoverLine!==n.lastHoverLine&&(n.lastHoverLine&&(n.dispatch("moveOutLine",n.lastHoverLine),n.hideTip()),n.moveIn.hoverLine&&(n.dispatch("moveInLine",n.moveIn.hoverLine),n.showTip(n.moveIn.hoverLine,e))),n.moveIn.type===r.LineControlPoint?n.hoverLayer.hoverLineCP=n.moveIn.lineControlPoint:n.hoverLayer.hoverLineCP&&(n.hoverLayer.hoverLineCP=null),n.moveIn.hoverNode===n.lastHoverNode&&n.moveIn.type!==r.HoverAnchors&&n.hoverLayer.lasthoverLineCP===n.hoverLayer.hoverLineCP||(n.hoverLayer.lasthoverLineCP=n.hoverLayer.hoverLineCP,n.render()),void(n.scheduledAnimationFrame=!1);var t=e.x+50>n.parentElem.clientWidth+n.parentElem.scrollLeft,c=e.y+50>n.parentElem.clientHeight+n.parentElem.scrollTop;if(t||c){n.dispatch("moveOutParent",e);var h=!1;e.x+50>n.divLayer.canvas.clientWidth&&(n.canvas.width+=200,h=!0),e.y+50>n.divLayer.canvas.clientHeight&&(n.canvas.height+=200,h=!0),h&&n.resize({width:n.canvas.width,height:n.canvas.height}),n.scroll(t?100:0,c?100:0)}var l=e.x-100<n.parentElem.scrollLeft,d=e.y-100<n.parentElem.scrollTop;switch((l||d)&&n.scroll(l?-100:0,d?-100:0),n.moveIn.type){case r.None:n.hoverLayer.dragRect=new k.Rect(n.mouseDown.x,n.mouseDown.y,e.x-n.mouseDown.x,e.y-n.mouseDown.y);break;case r.Nodes:if(n.activeLayer.locked())break;var f=e.x-n.mouseDown.x,y=e.y-n.mouseDown.y;if(f||y){var v=n.getDockPos(f,y);n.activeLayer.move(v.x?v.x:f,v.y?v.y:y),n.needCache=!0}break;case r.ResizeCP:n.activeLayer.resize(n.moveIn.activeAnchorIndex,n.mouseDown,e),n.dispatch("resizePens",n.activeLayer.pens),n.needCache=!0;break;case r.LineTo:case r.HoverAnchors:var m=n.data.toArrowType;n.moveIn.hoverLine&&(m=n.moveIn.hoverLine.toArrow),n.hoverLayer.line&&(n.activeLayer.pens=[n.hoverLayer.line]),n.hoverLayer.lineTo(n.getLineDock(e),m),n.needCache=!0;break;case r.LineFrom:n.hoverLayer.lineFrom(n.getLineDock(e)),n.needCache=!0;break;case r.LineMove:n.hoverLayer.lineMove(e,n.mouseDown),n.needCache=!0;break;case r.LineControlPoint:n.moveIn.hoverLine.controlPoints[n.moveIn.lineControlPoint.id].x=e.x,n.moveIn.hoverLine.controlPoints[n.moveIn.lineControlPoint.id].y=e.y,n.moveIn.hoverLine.textRect=null,x.drawLineFns[n.moveIn.hoverLine.name]&&x.drawLineFns[n.moveIn.hoverLine.name].dockControlPointFn&&x.drawLineFns[n.moveIn.hoverLine.name].dockControlPointFn(n.moveIn.hoverLine.controlPoints[n.moveIn.lineControlPoint.id],n.moveIn.hoverLine),n.needCache=!0,o.Store.set("LT:updateLines",[n.moveIn.hoverLine]);break;case r.Rotate:n.activeLayer.pens.length&&(n.activeLayer.offsetRotate(n.getAngle(e)),n.activeLayer.updateLines()),n.needCache=!0}n.render(),n.scheduledAnimationFrame=!1}))}}},this.onmousedown=function(t){switch(n.mouseDown={x:t.offsetX,y:t.offsetY},t.altKey&&(n.divLayer.canvas.style.cursor="move"),n.inputObj&&n.setNodeText(),n.moveIn.type){case r.None:n.activeLayer.clear(),n.hoverLayer.clear(),n.dispatch("space",n.mouseDown);break;case r.Line:case r.LineControlPoint:t.ctrlKey?(n.activeLayer.add(n.moveIn.hoverLine),n.dispatch("multi",n.activeLayer.pens)):(n.activeLayer.pens=[n.moveIn.hoverLine],n.dispatch("line",n.moveIn.hoverLine));break;case r.LineMove:n.hoverLayer.initLine=new f.Line(n.moveIn.hoverLine),n.moveIn.hoverLine.click();case r.LineFrom:case r.LineTo:n.activeLayer.pens=[n.moveIn.hoverLine],n.dispatch("line",n.moveIn.hoverLine),n.hoverLayer.line=n.moveIn.hoverLine;break;case r.HoverAnchors:n.hoverLayer.line=n.addLine({name:n.data.lineName,from:new d.Point(n.moveIn.hoverNode.rotatedAnchors[n.moveIn.hoverAnchorIndex].x,n.moveIn.hoverNode.rotatedAnchors[n.moveIn.hoverAnchorIndex].y,n.moveIn.hoverNode.rotatedAnchors[n.moveIn.hoverAnchorIndex].direction,n.moveIn.hoverAnchorIndex,n.moveIn.hoverNode.id),fromArrow:n.data.fromArrowType,to:new d.Point(n.moveIn.hoverNode.rotatedAnchors[n.moveIn.hoverAnchorIndex].x,n.moveIn.hoverNode.rotatedAnchors[n.moveIn.hoverAnchorIndex].y),toArrow:n.data.toArrowType,strokeStyle:n.options.color});case r.Nodes:if(!n.moveIn.activeNode)break;t.ctrlKey?n.moveIn.hoverNode&&n.activeLayer.hasInAll(n.moveIn.hoverNode)?(n.activeLayer.setPens([n.moveIn.hoverNode]),n.dispatch("node",n.moveIn.hoverNode)):n.activeLayer.has(n.moveIn.activeNode)||(n.activeLayer.add(n.moveIn.activeNode),n.activeLayer.pens.length>1?n.dispatch("multi",n.activeLayer.pens):n.dispatch("node",n.moveIn.activeNode)):t.shiftKey?n.moveIn.hoverNode?(n.activeLayer.setPens([n.moveIn.hoverNode]),n.dispatch("node",n.moveIn.hoverNode)):n.moveIn.hoverLine&&(n.activeLayer.setPens([n.moveIn.hoverLine]),n.dispatch("line",n.moveIn.hoverLine)):n.activeLayer.pens.length<2&&(n.activeLayer.setPens([n.moveIn.activeNode]),n.dispatch("node",n.moveIn.activeNode)),n.moveIn.activeNode.click()}n.activeLayer.pens.length&&n.activeLayer.saveNodeRects(),n.render()},this.onmouseup=function(t){if(n.mouseDown=null,n.lastTranlated.x=0,n.lastTranlated.y=0,n.hoverLayer.dockAnchor=null,n.hoverLayer.dockLineX=0,n.hoverLayer.dockLineY=0,n.divLayer.canvas.style.cursor="default",n.hoverLayer.dragRect)n.getPensInRect(n.hoverLayer.dragRect),n.activeLayer.pens&&n.activeLayer.pens.length&&n.dispatch("multi",n.activeLayer.pens);else switch(n.moveIn.type){case r.HoverAnchors:n.hoverLayer.line&&(n.hoverLayer.line.to.id||!n.options.disableEmptyLine?(n.activeLayer.pens=[n.hoverLayer.line],n.dispatch("addLine",n.hoverLayer.line)):n.data.pens.pop()),n.offscreen.render(),n.hoverLayer.line=null;break;case r.Rotate:n.activeLayer.updateRotate();break;case r.LineControlPoint:o.Store.set("pts-"+n.moveIn.hoverLine.id,null)}n.hoverLayer.dragRect=null,n.render(),n.needCache&&n.cache(),n.needCache=!1},this.ondblclick=function(t){n.moveIn.hoverNode?(n.dispatch("dblclick",{node:n.moveIn.hoverNode}),n.moveIn.hoverNode.getTextRect().hit(new d.Point(t.offsetX,t.offsetY))&&n.showInput(n.moveIn.hoverNode),n.moveIn.hoverNode.dblclick()):n.moveIn.hoverLine&&(n.dispatch("dblclick",{line:n.moveIn.hoverLine}),n.moveIn.hoverLine.text&&!n.moveIn.hoverLine.getTextRect().hit(new d.Point(t.offsetX,t.offsetY))||n.showInput(n.moveIn.hoverLine),n.moveIn.hoverLine.dblclick())},this.onkeydown=function(t){if(!n.data.locked&&"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName){var e=!1,r=0,o=0;switch(t.key){case"a":case"A":n.activeLayer.setPens(n.data.pens),e=!0;break;case"Delete":case"Backspace":n.delete();break;case"ArrowLeft":r=-5,t.ctrlKey&&(r=-1),e=!0;break;case"ArrowUp":o=-5,t.ctrlKey&&(o=-1),e=!0;break;case"ArrowRight":r=5,t.ctrlKey&&(r=1),e=!0;break;case"ArrowDown":o=5,t.ctrlKey&&(o=1),e=!0;break;case"x":case"X":n.cut();break;case"c":case"C":n.copy();break;case"v":case"V":n.paste();break;case"y":case"Y":t.ctrlKey&&n.redo();break;case"z":case"Z":t.shiftKey?n.redo():n.undo()}e&&(t.preventDefault(),(r||o)&&(n.activeLayer.saveNodeRects(),n.activeLayer.move(r,o),n.overflow(),n.animateLayer.animate()),n.render(),n.cache())}},o.Store.set("topology-data",this.data),e||(e={});var h=Object.assign({},c.DefalutOptions.font,e.font);switch(e.font=h,this.options=Object.assign({},c.DefalutOptions,e),this.parentElem="string"==typeof t?document.getElementById(t):t,this.parentElem.style.position="relative",this.activeLayer=new R.ActiveLayer(this.options),this.hoverLayer=new P.HoverLayer(this.options),this.animateLayer=new L.AnimateLayer(this.options),this.offscreen=new m.Offscreen(this.parentElem,this.options),this.canvas=new w.RenderLayer(this.parentElem,this.options),this.divLayer=new T.DivLayer(this.parentElem,this.options),this.resize(),this.divLayer.canvas.ondragover=function(t){return t.preventDefault()},this.divLayer.canvas.ondrop=function(t){n.ondrop(t)},this.subcribe=o.Store.subscribe("LT:render",(function(){n.render()})),this.subcribeImage=o.Store.subscribe("LT:imageLoaded",(function(){n.imageTimer&&clearTimeout(n.imageTimer),n.imageTimer=setTimeout((function(){n.render()}),100)})),this.subcribeAnimateMoved=o.Store.subscribe("LT:rectChanged",(function(t){n.activeLayer.updateLines(n.data.pens)})),this.subcribeMediaEnd=o.Store.subscribe("mediaEnd",(function(t){t.nextPlay&&(n.animateLayer.readyPlay(t.nextPlay),n.animateLayer.animate()),n.dispatch("mediaEnd",t)})),this.subcribeAnimateEnd=o.Store.subscribe("animateEnd",(function(t){if(t){switch(t.type){case"node":n.offscreen.render()}n.divLayer.playNext(t.data.nextAnimate),n.dispatch("animateEnd",t)}})),this.divLayer.canvas.onmousemove=this.onMouseMove,this.divLayer.canvas.onmousedown=this.onmousedown,this.divLayer.canvas.onmouseup=this.onmouseup,this.divLayer.canvas.ondblclick=this.ondblclick,this.divLayer.canvas.tabIndex=0,this.divLayer.canvas.onblur=function(){n.mouseDown=null},this.divLayer.canvas.onwheel=function(t){if(!n.options.disableScale){switch(n.options.scaleKey){case c.KeyType.None:break;case c.KeyType.Ctrl:if(!t.ctrlKey)return;break;case c.KeyType.Shift:if(!t.shiftKey)return;break;case c.KeyType.Alt:if(!t.altKey)return;break;default:if(!t.ctrlKey&&!t.altKey)return}return t.preventDefault(),t.deltaY<0?n.scale(1.1):n.scale(.9),n.divLayer.canvas.focus(),!1}},this.divLayer.canvas.ontouchend=function(t){n.ontouched(t)},this.options.keydown){case c.KeydownType.Document:document.onkeydown=this.onkeydown;break;case c.KeydownType.Canvas:this.divLayer.canvas.onkeydown=this.onkeydown}this.input.style.position="absolute",this.input.style.zIndex="-1",this.input.style.left="-1000px",this.input.style.width="0",this.input.style.height="0",this.input.style.outline="none",this.input.style.border="1px solid #cdcdcd",this.input.style.resize="none",this.parentElem.appendChild(this.input),this.createMarkdownTip(),this.cache(),window.addEventListener("resize",this.winResize)}return t.prototype.resize=function(t){this.canvas.resize(t),this.offscreen.resize(t),this.divLayer.resize(t),this.render(),this.dispatch("resize",t)},t.prototype.ondrop=function(t){t.preventDefault();try{var e=JSON.parse(t.dataTransfer.getData("Text"));if(e.rect.x=t.offsetX-e.rect.width/2<<0,e.rect.y=t.offsetY-e.rect.height/2<<0,"lineAlone"===e.name)this.addLine({name:this.data.lineName,from:new d.Point(e.rect.x,e.rect.y),fromArrow:this.data.fromArrowType,to:new d.Point(e.rect.x+e.rect.width,e.rect.y+e.rect.height),toArrow:this.data.toArrowType,strokeStyle:this.options.color},!0);else{var n=new l.Node(e);this.addNode(n,!0),"div"===n.name&&this.dispatch("LT:addDiv",n)}this.divLayer.canvas.focus()}catch(t){}},t.prototype.getTouchOffset=function(t){for(var e=this.parentElem,n=0,r=0;e;)n+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;return{offsetX:t.pageX-n,offsetY:t.pageY-r}},t.prototype.ontouched=function(t){if(this.touchedNode){var e=this.getTouchOffset(t.changedTouches[0]);this.touchedNode.rect.x=e.offsetX-this.touchedNode.rect.width/2,this.touchedNode.rect.y=e.offsetY-this.touchedNode.rect.height/2,this.addNode(new l.Node(this.touchedNode),!0),this.touchedNode=void 0}},t.prototype.addNode=function(t,e){if(void 0===e&&(e=!1),this.data.locked||!x.drawNodeFns[t.name])return null;for(var n in t.init||(t=new l.Node(t)),!t.strokeStyle&&this.options.color&&(t.strokeStyle=this.options.color),t.font)t.font[n]||(t.font[n]=this.options.font[n]);return 1!==this.data.scale&&t.scale(this.data.scale),this.data.pens.push(t),e&&(this.activeLayer.setPens([t]),this.render(),this.cache(),this.dispatch("addNode",t)),t},t.prototype.addLine=function(line,t){return void 0===t&&(t=!1),this.data.locked?null:(line.clone||(line=new f.Line(line)).calcControlPoints(!0),this.data.pens.push(line),t&&(this.activeLayer.setPens([line]),this.render(),this.cache(),this.dispatch("addLine",line)),line)},t.prototype.render=function(t){void 0===t&&(t=!1),t&&(this.activeLayer.pens=[],this.hoverLayer.node=null,this.hoverLayer.line=null),this.offscreen.render(),this.canvas.render()},t.prototype.open=function(data){for(var t in data||(data={pens:[]}),"string"==typeof data&&(data=JSON.parse(data)),this.divLayer.clear(),l.images)delete l.images[t];if(this.animateLayer.stop(),this.lock(data.locked||v.Lock.None),data.lineName&&(this.data.lineName=data.lineName),this.data.fromArrowType=data.fromArrowType,this.data.toArrowType=data.toArrowType,this.data.scale=data.scale||1,o.Store.set("LT:scale",this.data.scale),this.dispatch("scale",this.data.scale),this.data.bkColor=data.bkColor,this.data.bkImage=data.bkImage,this.data.pens=[],data.nodes){for(var e=0,n=data.nodes;e<n.length;e++){var r=n[e];this.data.pens.push(new l.Node(r))}for(var c=0,h=data.lines;c<h.length;c++){r=h[c];this.data.pens.push(new f.Line(r))}}if(data.pens)for(var d=0,y=data.pens;d<y.length;d++){(r=y[d]).from?this.data.pens.push(new f.Line(r)):this.data.pens.push(new l.Node(r))}this.data.grid=data.grid,"object"==typeof data.data?this.data.data=JSON.parse(JSON.stringify(data.data)):this.data.data=data.data||"",this.caches.list=[],this.cache(),this.overflow(),this.render(!0),this.animate(!0),this.socket&&this.socket.close(),this.data.websocket&&(this.socket=new _.Socket(this.data.websocket,this.data.pens))},t.prototype.overflow=function(){var rect=this.getRect(),t=this.canvas,e=t.width,n=t.height,r=rect.ex,o=rect.ey;r>e&&(e=r+200),o>n&&(n=o+200),this.resize({width:e,height:n})},t.prototype.setNodeText=function(){this.inputObj.text=this.input.value,this.input.style.zIndex="-1",this.input.style.left="-1000px",this.input.style.width="0",this.cache(),this.offscreen.render(),this.dispatch("setText",this.inputObj),this.inputObj=null},t.prototype.getMoveIn=function(t){if(this.lastHoverNode=this.moveIn.hoverNode,this.lastHoverLine=this.moveIn.hoverLine,this.moveIn.type=r.None,this.moveIn.hoverNode=null,this.moveIn.lineControlPoint=null,this.moveIn.hoverLine=null,this.hoverLayer.hoverAnchorIndex=-1,!this.data.locked&&(1!==this.activeLayer.pens.length||!this.activeLayer.pens[0].type)&&!this.activeLayer.locked()&&this.activeLayer.rotateCPs[0]&&this.activeLayer.rotateCPs[0].hit(t,15))return this.moveIn.type=r.Rotate,void(this.divLayer.canvas.style.cursor='url("'+this.options.rotateCursor+'"), auto');if(this.activeLayer.pens.length&&M.pointInRect(t,this.activeLayer.sizeCPs)&&(this.moveIn.type=r.Nodes),!this.data.locked&&!this.activeLayer.locked()&&!this.options.hideSizeCP&&(this.activeLayer.pens.length>1||!this.activeLayer.pens[0].type&&!this.activeLayer.pens[0].hideSizeCP))for(var i=0;i<this.activeLayer.sizeCPs.length;++i)if(this.activeLayer.sizeCPs[i].hit(t,10))return this.moveIn.type=r.ResizeCP,this.moveIn.activeAnchorIndex=i,void(this.divLayer.canvas.style.cursor=A[i]);for(var e=0,n=this.activeLayer.pens;e<n.length;e++){if((y=n[e])instanceof f.Line){for(i=0;i<y.controlPoints.length;++i)if(!y.locked&&y.controlPoints[i].hit(t,10))return y.controlPoints[i].id=i,this.moveIn.type=r.LineControlPoint,this.moveIn.lineControlPoint=y.controlPoints[i],this.moveIn.hoverLine=y,void(this.divLayer.canvas.style.cursor="pointer");if(this.inLine(t,y))return}}this.divLayer.canvas.style.cursor="default";for(var o=0,c=this.data.pens;o<c.length;o++){(y=c[o])instanceof l.Node&&this.inNode(t,y)}if(this.moveIn.type!==r.HoverAnchors)for(var h=0,d=this.data.pens;h<d.length;h++){var y;(y=d[h])instanceof f.Line&&this.inLine(t,y)}},t.prototype.inChildNode=function(t,e){if(!e)return null;for(var n=0,r=e;n<r.length;n++){var o=r[n];if(o.type!==h.PenType.Line){var c=this.inChildNode(t,o.children);if(c)return c;if(c=this.inNode(t,o,!0))return c}else if(this.inLine(t,o))return o}return null},t.prototype.inNode=function(t,e,n){if(void 0===n&&(n=!1),this.data.locked===v.Lock.NoEvent||e.locked===v.Lock.NoEvent)return null;var o=this.inChildNode(t,e.children);if(o)return o.type===h.PenType.Line?(this.moveIn.activeNode=e,this.moveIn.type=r.Nodes):o.stand&&(this.moveIn.activeNode=o,this.moveIn.type=r.Nodes),o;if(e.hit(t)){if(this.moveIn.hoverNode=e,this.moveIn.type=r.Nodes,this.divLayer.canvas.style.cursor="move",!(this.options.hideAnchor||e.hideAnchor||e.rect.width<20||e.rect.height<20))for(var c=0;c<e.rotatedAnchors.length;++c)if(e.rotatedAnchors[c].hit(t,5)){if(!this.mouseDown&&e.rotatedAnchors[c].mode===v.AnchorMode.In)continue;this.moveIn.type=r.HoverAnchors,this.moveIn.hoverAnchorIndex=c,this.hoverLayer.hoverAnchorIndex=c,this.divLayer.canvas.style.cursor="crosshair";break}return n||(this.moveIn.activeNode=this.moveIn.hoverNode),e}if(this.options.hideAnchor||e.hideAnchor||this.data.locked||e.locked)return null;if(e.hit(t,5))for(c=0;c<e.rotatedAnchors.length;++c)if(e.rotatedAnchors[c].hit(t,5)){if(!this.mouseDown&&e.rotatedAnchors[c].mode===v.AnchorMode.In)continue;return this.moveIn.hoverNode=e,this.moveIn.type=r.HoverAnchors,this.moveIn.hoverAnchorIndex=c,this.hoverLayer.hoverAnchorIndex=c,this.divLayer.canvas.style.cursor="crosshair",n||(this.moveIn.activeNode=e),e}return null},t.prototype.inLine=function(t,line){return line.from.hit(t,10)?(this.moveIn.type=r.LineFrom,this.moveIn.hoverLine=line,this.data.locked||line.locked?this.divLayer.canvas.style.cursor="pointer":this.divLayer.canvas.style.cursor="move",!0):line.to.hit(t,10)?(this.moveIn.type=r.LineTo,this.moveIn.hoverLine=line,this.data.locked||line.locked?this.divLayer.canvas.style.cursor="pointer":this.divLayer.canvas.style.cursor="move",!0):!!line.pointIn(t)&&(this.moveIn.type=r.LineMove,this.moveIn.hoverLine=line,this.divLayer.canvas.style.cursor="pointer",(line.from.id||line.to.id)&&(this.moveIn.type=r.Line),!0)},t.prototype.getLineDock=function(t){this.hoverLayer.dockAnchor=null;for(var e=0,n=this.data.pens;e<n.length;e++){var r=n[e];if(r instanceof l.Node){r.rect.hit(t,10)&&(this.hoverLayer.node=r);for(var i=0;i<r.rotatedAnchors.length;++i)if((!r.rotatedAnchors[i].mode||r.rotatedAnchors[i].mode===v.AnchorMode.In)&&r.rotatedAnchors[i].hit(t,10)){t.id=r.id,t.anchorIndex=i,t.direction=r.rotatedAnchors[t.anchorIndex].direction,t.x=r.rotatedAnchors[t.anchorIndex].x,t.y=r.rotatedAnchors[t.anchorIndex].y,this.hoverLayer.dockAnchor=r.rotatedAnchors[i];break}}else if(r instanceof f.Line){if(r.id===this.hoverLayer.line.id)continue;if(r.from.hit(t,10)){t.x=r.from.x,t.y=r.from.y,this.hoverLayer.dockAnchor=r.from;break}if(r.to.hit(t,10)){t.x=r.to.x,t.y=r.to.y,this.hoverLayer.dockAnchor=r.to;break}if(r.controlPoints)for(var o=0,c=r.controlPoints;o<c.length;o++){var h=c[o];if(h.hit(t,10)){t.x=h.x,t.y=h.y,this.hoverLayer.dockAnchor=h;break}}}if(this.hoverLayer.dockAnchor)break}return t},t.prototype.getPensInRect=function(rect){rect.width<0&&(rect.width=-rect.width,rect.x=rect.ex,rect.ex=rect.x+rect.width),rect.height<0&&(rect.height=-rect.height,rect.y=rect.ey,rect.ey=rect.y+rect.height),this.activeLayer.pens=[];for(var t=0,e=this.data.pens;t<e.length;t++){var n=e[t];n.locked!==v.Lock.NoEvent&&(n instanceof l.Node&&rect.hitByRect(n.rect)&&this.activeLayer.add(n),n instanceof f.Line&&rect.hit(n.from)&&rect.hit(n.to)&&this.activeLayer.add(n))}},t.prototype.getAngle=function(t){if(t.x===this.activeLayer.rect.center.x)return t.y<=this.activeLayer.rect.center.y?0:180;if(t.y===this.activeLayer.rect.center.y)return t.x<this.activeLayer.rect.center.x?270:90;var e=t.x-this.activeLayer.rect.center.x,n=t.y-this.activeLayer.rect.center.y,r=Math.atan(Math.abs(e/n))/(2*Math.PI)*360;return e>0&&n>0?r=180-r:e<0&&n>0?r+=180:e<0&&n<0&&(r=360-r),1===this.activeLayer.pens.length?r-this.activeLayer.pens[0].rotate:r},t.prototype.showInput=function(t){if(!(this.data.locked||t.locked||t.hideInput||this.options.hideInput)){this.inputObj=t;var e=t.getTextRect();this.input.value=t.text||"",this.input.style.left=e.x+"px",this.input.style.top=e.y+"px",this.input.style.width=e.width+"px",this.input.style.height=e.height+"px",this.input.style.zIndex="1000",this.input.focus()}},t.prototype.getRect=function(t){return t||(t=this.data.pens),S.getRect(t)},t.prototype.getDockPos=function(t,e){this.hoverLayer.dockLineX=0,this.hoverLayer.dockLineY=0;for(var n={x:0,y:0},r=10,o=10,c=0,h=this.activeLayer.dockWatchers;c<h.length;c++)for(var d=h[c],f=0,y=this.data.pens;f<y.length;f++){var v=y[f];if(v instanceof l.Node&&!this.activeLayer.has(v)&&"text"!==v.name){v.dockWatchers||v.getDockWatchers();for(var x=0,m=v.dockWatchers;x<m.length;x++){var p=m[x];Math.abs(p.x-d.x-t)<r&&(r=-99999,n.x=p.x-d.x,this.hoverLayer.dockLineX=0|p.x),Math.abs(p.y-d.y-e)<o&&(o=-99999,n.y=p.y-d.y,this.hoverLayer.dockLineY=0|p.y)}}}return n},t.prototype.cache=function(){this.caches.index<this.caches.list.length-1&&this.caches.list.splice(this.caches.index+1,this.caches.list.length-this.caches.index-1);var data=new y.TopologyData(this.data);this.caches.list.push(data),this.caches.list.length>this.options.cacheLen&&this.caches.list.shift(),this.caches.index=this.caches.list.length-1},t.prototype.cacheReplace=function(t){if(t&&t.length){for(var e={},i=0,n=t.length;i<n;i++){var r=t[i],o=r.id;r instanceof l.Node?e[o]=new l.Node(r):r instanceof f.Line&&(e[o]=new f.Line(r))}var c=this.caches.list[0];if(!c)return;for(i=0,n=c.pens.length;i<n;i++){e[o=c.pens[i].id]&&(c.pens[i]=e[o])}}},t.prototype.undo=function(t){if(void 0===t&&(t=!1),!(this.data.locked||this.caches.index<1)){this.divLayer.clear();var data=new y.TopologyData(this.caches.list[--this.caches.index]);this.data.pens.splice(0,this.data.pens.length),this.data.pens.push.apply(this.data.pens,data.pens),this.render(!0),this.divLayer.render(),t&&this.caches.list.splice(this.caches.index+1,this.caches.list.length-this.caches.index-1),this.dispatch("undo",this.data)}},t.prototype.redo=function(){if(!(this.data.locked||this.caches.index>this.caches.list.length-2)){this.divLayer.clear();var data=new y.TopologyData(this.caches.list[++this.caches.index]);this.data.pens.splice(0,this.data.pens.length),this.data.pens.push.apply(this.data.pens,data.pens),this.render(!0),this.divLayer.render(),this.dispatch("redo",this.data)}},t.prototype.toImage=function(t,e,n,r,o){void 0===o&&(o=!0);var rect=new k.Rect(0,0,this.canvas.width,this.canvas.height);o&&(rect=this.getRect()),r||(r={left:10,top:10,right:10,bottom:10}),rect.x-=r.left,rect.y-=r.top,rect.width+=r.left+r.right,rect.height+=r.top+r.bottom,rect.round();var c=rect.clone();c.scale(this.offscreen.getDpiRatio(),new d.Point(0,0)),c.round();var canvas=document.createElement("canvas");canvas.width=c.width,canvas.height=c.height,canvas.style.width=rect.width+"px",canvas.style.height=rect.height+"px";var h=canvas.getContext("2d");return t&&"image/png"!==t&&(h.fillStyle="white",h.fillRect(0,0,canvas.width,canvas.height)),h.drawImage(this.canvas.canvas,c.x,c.y,c.width,c.height,0,0,c.width,c.height),n?(canvas.toBlob(n),""):canvas.toDataURL(t,e)},t.prototype.saveAsImage=function(t,e,n,r,o){void 0===o&&(o=!0);var a=document.createElement("a");a.setAttribute("download",t||"le5le.topology.png"),a.setAttribute("href",this.toImage(e,n,null,r,o));var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!0),a.dispatchEvent(c)},t.prototype.delete=function(t){for(var e=[],i=0,n=0,r=this.activeLayer.pens;n<r.length;n++){var o=r[n];!t&&o.locked||((i=this.find(o))>-1&&(this.data.pens[i].type===h.PenType.Node&&this.divLayer.removeDiv(this.data.pens[i]),e.push.apply(e,this.data.pens.splice(i,1))),this.animateLayer.pens.delete(o.id))}e.length&&(this.render(!0),this.cache(),this.dispatch("delete",e))},t.prototype.removeNode=function(t){var i=this.find(t);if(i>-1){this.divLayer.removeDiv(this.data.pens[i]);var e=this.data.pens.splice(i,1);this.dispatch("delete",{nodes:e})}this.render(!0),this.cache()},t.prototype.removeLine=function(line){var i=this.find(line);if(i>-1){var t=this.data.pens.splice(i,1);this.dispatch("delete",{lines:t})}this.render(!0),this.cache()},t.prototype.cut=function(){if(!this.data.locked){this.clipboard=new y.TopologyData({pens:[]});for(var t=0,e=this.activeLayer.pens;t<e.length;t++){var n=e[t];this.clipboard.pens.push(n.clone());var i=this.find(n);i>-1&&(n.type===h.PenType.Node&&this.divLayer.removeDiv(this.data.pens[i]),this.data.pens.splice(i,1))}this.cache(),this.activeLayer.clear(),this.hoverLayer.node=null,this.moveIn.hoverLine=null,this.moveIn.hoverNode=null,this.render(),this.dispatch("delete",{pens:this.clipboard.pens})}},t.prototype.copy=function(){this.clipboard=new y.TopologyData({pens:[]});for(var t=0,e=this.activeLayer.pens;t<e.length;t++){var n=e[t];this.clipboard.pens.push(n.clone())}},t.prototype.paste=function(){if(this.clipboard&&!this.data.locked){this.hoverLayer.node=null,this.hoverLayer.line=null,this.activeLayer.pens=[];for(var t={},e=0,n=this.clipboard.pens;e<n.length;e++){var r=n[e];if(r.type===h.PenType.Node&&(this.newId(r,t),r.rect.x+=20,r.rect.ex+=20,r.rect.y+=20,r.rect.ey+=20,r.init()),r instanceof f.Line){r.id=I.s8(),r.from=new d.Point(r.from.x+20,r.from.y+20,r.from.direction,r.from.anchorIndex,t[r.from.id]),r.to=new d.Point(r.to.x+20,r.to.y+20,r.to.direction,r.to.anchorIndex,t[r.to.id]);for(var o=[],c=0,l=r.controlPoints;c<l.length;c++){var y=l[c];o.push(new d.Point(y.x+20,y.y+20))}r.controlPoints=o}this.data.pens.push(r),this.activeLayer.add(r)}this.render(),this.cache(),this.copy(),this.clipboard.pens.length>1?this.dispatch("multi",{pens:this.clipboard.pens}):this.activeLayer.pens[0].type===h.PenType.Node?this.dispatch("addNode",this.activeLayer.pens[0]):this.activeLayer.pens[0].type===h.PenType.Line&&this.dispatch("addLine",this.activeLayer.pens[0])}},t.prototype.newId=function(t,e){var n=t.id;if(t.id=I.s8(),e[n]=t.id,t.children)for(var r=0,o=t.children;r<o.length;r++){var c=o[r];this.newId(c,e)}},t.prototype.animate=function(t){void 0===t&&(t=!1),this.animateLayer.readyPlay(null,t),this.animateLayer.animate()},t.prototype.updateProps=function(t,e){void 0===t&&(t=!0),e||(e=this.activeLayer.pens);for(var n=0,r=e;n<r.length;n++){var o=r[n];o instanceof l.Node&&(o.init(),o.initRect())}this.activeLayer.updateLines(e),this.activeLayer.calcControlPoints(),this.activeLayer.saveNodeRects(),this.render(),t&&this.cache()},t.prototype.lock=function(t){this.data.locked=t,this.dispatch("locked",this.data.locked)},t.prototype.lockPens=function(t,e){for(var n=0,r=this.data.pens;n<r.length;n++)for(var o=r[n],c=0,h=t;c<h.length;c++){var l=h[c];if(o.id===l.id){o.locked=e;break}}this.dispatch("lockPens",{pens:t,lock:e})},t.prototype.top=function(t){var i=this.find(t);i>-1&&(this.data.pens.push(this.data.pens[i]),this.data.pens.splice(i,1))},t.prototype.bottom=function(t){var i=this.find(t);i>-1&&(this.data.pens.unshift(this.data.pens[i]),this.data.pens.splice(i+1,1))},t.prototype.combine=function(t,e){void 0===e&&(e=!1),t||(t=this.activeLayer.pens);for(var rect=this.getRect(t),n=0,r=t;n<r.length;n++){var o=r[n];(i=this.find(o))>-1&&this.data.pens.splice(i,1)}for(var c=new l.Node({name:"combine",rect:new k.Rect(rect.x,rect.y,rect.width,rect.height),text:"",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,strokeStyle:"transparent",children:[]}),i=0;i<t.length;++i)if(t[i].type===h.PenType.Node&&rect.width===t[i].rect.width&&rect.height===t[i].rect.height){(c=t[i]).children||(c.children=[]),t.splice(i,1);break}for(var d=0,f=t;d<f.length;d++){(o=f[d]).stand=e,o.parentId=c.id,o.calcRectInParent(c),c.children.push(o)}this.data.pens.push(c),this.activeLayer.setPens([c]),this.dispatch("node",c),this.cache()},t.prototype.uncombine=function(t){if(t||(t=this.activeLayer.pens[0]),t instanceof l.Node){for(var e=0,n=t.children;e<n.length;e++){var r=n[e];r.parentId=void 0,r.rectInParent=void 0,r.locked=v.Lock.None,this.data.pens.push(r)}var i=this.find(t);i>-1&&"combine"===t.name?this.data.pens.splice(i,1):t.children=null,this.cache(),this.activeLayer.clear(),this.hoverLayer.clear()}},t.prototype.find=function(t){for(var i=0;i<this.data.pens.length;++i)if(t.id===this.data.pens[i].id)return i;return-1},t.prototype.translate=function(t,e,n){n||(this.lastTranlated.x=0,this.lastTranlated.y=0);for(var r=t-this.lastTranlated.x,o=e-this.lastTranlated.y,c=0,h=this.data.pens;c<h.length;c++){h[c].translate(r,o)}this.lastTranlated.x=t,this.lastTranlated.y=e,this.overflow(),this.render(),this.cache(),this.dispatch("translate",{x:t,y:e})},t.prototype.scale=function(t){if(!(this.data.scale*t<this.options.minScale||this.data.scale*t>this.options.maxScale)){this.data.scale*=t;for(var e=this.getRect().center,n=0,r=this.data.pens;n<r.length;n++){r[n].scale(t,e)}o.Store.set("LT:scale",this.data.scale),this.render(),this.overflow(),this.cache(),this.dispatch("scale",this.data.scale)}},t.prototype.scaleTo=function(t){this.scale(t/this.data.scale)},t.prototype.round=function(){for(var t=0,e=this.data.pens;t<e.length;t++){var n=e[t];n instanceof l.Node&&n.round()}},t.prototype.createMarkdownTip=function(){this.tipMarkdown=document.createElement("div"),this.tipMarkdown.style.position="fixed",this.tipMarkdown.style.zIndex="-1",this.tipMarkdown.style.left="-9999px",this.tipMarkdown.style.width="500px",this.tipMarkdown.style.outline="none",this.tipMarkdown.style.border="1px solid #d0d0d0",this.tipMarkdown.style.backgroundColor="#fff",this.tipMarkdown.style.padding="10px 15px",this.tipMarkdown.style.overflowY="auto",this.tipMarkdown.style.minHeight="30px",this.tipMarkdown.style.maxHeight="260px",document.body.appendChild(this.tipMarkdown)},t.prototype.showTip=function(data,t){if(this.data.locked&&data&&(data.markdown||data.tipId||data.title)&&data.id!==this.tip){if(data.title)return this.divLayer.canvas.title=data.title,void(this.tip=data.id);data.tipId&&(this.tipElem=document.getElementById(data.tipId));var e=this.tipElem;if(data.markdown){e=this.tipMarkdown;var n=window.marked;this.tipMarkdown.innerHTML=n?n(data.markdown):data.markdown;for(var a=this.tipMarkdown.getElementsByTagName("A"),i=0;i<a.length;++i)a[i].setAttribute("target","_blank")}var r=this.parentElem.getBoundingClientRect(),o=e.getBoundingClientRect(),c=t.x+r.left-o.width/2,h=t.y+r.top;data instanceof l.Node&&(c=r.left+data.rect.center.x-o.width/2,h=r.top+data.rect.ey),c-=this.parentElem.scrollLeft,h-=this.parentElem.scrollTop,c<0&&(c=0),c+o.width>document.body.clientWidth&&(c=document.body.clientWidth-o.width),h+o.height>document.body.clientHeight&&(h=document.body.clientHeight-o.height),e.style.position="fixed",e.style.left=c+"px",e.style.top=h+"px",e.style.zIndex="100",this.tip=data.id,this.dispatch("tip",e)}},t.prototype.hideTip=function(){this.tip&&(this.tipMarkdown.style.left="-9999px",this.tipMarkdown.style.zIndex="-1",this.tipElem&&(this.tipElem.style.left="-9999px",this.tipElem.style.zIndex="-1",this.tipElem=null),this.divLayer.canvas.title="",this.tip="")},t.prototype.scroll=function(t,e){var n=this;this.scrolling||(this.scrolling=!0,this.parentElem.scrollLeft+=t,this.parentElem.scrollTop+=e,setTimeout((function(){n.scrolling=!1}),700))},t.prototype.toComponent=function(t){t||(t=this.data.pens);for(var rect=this.getRect(t),e=new l.Node({name:"combine",rect:new k.Rect(rect.x,rect.y,rect.width,rect.height),text:"",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0,strokeStyle:"transparent",children:[]}),n=0,r=t;n<r.length;n++){if((d=r[n]).type===h.PenType.Node&&rect.width===d.rect.width&&rect.height===d.rect.height){(e=d).children||(e.children=[]);break}}for(var o=0,c=t;o<c.length;o++){var d;(d=c[o])!==e&&(d.parentId=e.id,d.calcRectInParent(e),e.children.push(d))}return e},t.prototype.clearBkImg=function(){this.canvas.clearBkImg()},t.prototype.dispatch=function(t,data){this.options.on&&this.options.on(t,data)},t.prototype.destroy=function(){this.subcribe.unsubscribe(),this.subcribeImage.unsubscribe(),this.subcribeAnimateEnd.unsubscribe(),this.subcribeAnimateMoved.unsubscribe(),this.subcribeMediaEnd.unsubscribe(),this.animateLayer.destroy(),this.divLayer.destroy(),document.body.removeChild(this.tipMarkdown),window.removeEventListener("resize",this.winResize),this.socket&&this.socket.close()},t}();e.Topology=C},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.get=function(t){var e,n=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(n))?decodeURIComponent(e[2]):""},t.set=function(t,e,n){var r=window,o=r.escape(t)+"="+r.escape(e)+";";(n||(n={}),n.expires)&&(o+="expires="+new Date((new Date).getTime()+1e3*n.expires*60*60*24).toUTCString()+";");n.path&&(o+="path="+n.path+";"),n.domain&&(o+="domain="+n.domain+";"),document.cookie=o},t.delete=function(e,n){t.get(e)&&(n||(n={}),n.expires=-1,t.set(e,"",n))},t}();e.Cookie=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(339),o=n(340),c=n(357),h=function(){function t(){this.data={},this.observers={}}return t.prototype.get=function(e){return t.get(e,this.data)},t.prototype.set=function(e,n){t.set(e,n,this.data,this.observers)},t.prototype.updated=function(e){t.updated(e,this.data,this.observers)},t.prototype.subscribe=function(e,n){return t.subscribe(e,n,this.data,this.observers)},t.get=function(t,e){if(e||(e=r.data),void 0===t)return e;for(var n=0,o=t.split(".");n<o.length;n++){if(void 0===(e=e[o[n]]))break}return e},t.set=function(e,n,o,c){o||(o=r.data),c||(c=r.observers);for(var h=e.split("."),l=o,i=0;i<h.length-1;++i)l[h[i]]||(l[h[i]]={}),l=l[h[i]];for(var d in l[h[h.length-1]]=n,c)0===e.indexOf(c[d].key)&&c[d].fn(t.get(c[d].key,o))},t.updated=function(e,n,o){for(var c in o||(o=r.observers),o)0===e.indexOf(o[c].key)&&o[c].fn(t.get(o[c].key,n))},t.subscribe=function(e,n,h,l){l||(l=r.observers);var d=c.s8(),f=new o.Observer(d,e,n);l[d]=f;var y=t.get(e,h);return void 0!==y&&n(y),f},t}();e.Store=h},function(t,e,n){"use strict";function r(){return(65536*(1+Math.random())|0).toString(16).substring(1)}Object.defineProperty(e,"__esModule",{value:!0}),e.s4=r,e.s8=function(){return r()+r()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(343),o=n(359),c=n(360),h=n(361),l=n(362),d=n(331),f=n(363),y=n(364),v=n(365),x=n(366),m=n(367),w=n(368),P=n(369),R=n(370),L=n(371),T=n(372),k=n(373),I=n(332),M=n(374),S=n(375),_=n(376),A=n(377),C=n(378),N=n(379),O=n(380),D=n(381),F=n(382),j=n(383),B=n(384),z=n(385),E=n(386),W=n(387),H=n(388),U=n(389),K=n(390),X=n(391),Y=n(392),G=n(393),J=n(394),V=n(395),Q=n(396),Z=n(398),$=n(399),tt=n(400),et=n(401),it=n(402);e.drawNodeFns={},e.iconRectFns={},e.textRectFns={},e.anchorsFns={},e.drawLineFns={},e.drawArrowFns={},console.log("Init middles."),e.drawNodeFns.combine=r.rectangle,e.drawNodeFns.div=r.rectangle,e.drawNodeFns.square=r.rectangle,e.drawNodeFns.rectangle=r.rectangle,e.iconRectFns.rectangle=it.rectangleIconRect,e.textRectFns.rectangle=it.rectangleTextRect,e.drawNodeFns.circle=o.circle,e.iconRectFns.circle=m.circleIconRect,e.textRectFns.circle=m.circleTextRect,e.anchorsFns.circle=A.circleAnchors,e.drawNodeFns.triangle=c.triangle,e.anchorsFns.triangle=y.triangleAnchors,e.iconRectFns.triangle=w.triangleIconRect,e.textRectFns.triangle=w.triangleTextRect,e.drawNodeFns.diamond=h.diamond,e.iconRectFns.diamond=P.diamondIconRect,e.textRectFns.diamond=P.diamondTextRect,e.drawNodeFns.hexagon=F.hexagon,e.iconRectFns.hexagon=B.hexagonIconRect,e.textRectFns.hexagon=B.hexagonTextRect,e.anchorsFns.hexagon=j.hexagonAnchors,e.drawNodeFns.pentagon=N.pentagon,e.iconRectFns.pentagon=O.pentagonIconRect,e.textRectFns.pentagon=O.pentagonTextRect,e.anchorsFns.pentagon=D.pentagonAnchors,e.drawNodeFns.pentagram=z.pentagram,e.iconRectFns.pentagram=W.pentagramIconRect,e.textRectFns.pentagram=W.pentagramTextRect,e.anchorsFns.pentagram=E.pentagramAnchors,e.drawNodeFns.leftArrow=l.leftArrow,e.anchorsFns.leftArrow=v.arrowAnchors,e.iconRectFns.leftArrow=R.leftArrowIconRect,e.textRectFns.leftArrow=R.leftArrowTextRect,e.drawNodeFns.rightArrow=l.rightArrow,e.anchorsFns.rightArrow=v.arrowAnchors,e.iconRectFns.rightArrow=R.rightArrowIconRect,e.textRectFns.rightArrow=R.rightArrowTextRect,e.drawNodeFns.twowayArrow=l.twowayArrow,e.anchorsFns.twowayArrow=v.arrowAnchors,e.iconRectFns.twowayArrow=R.twowayArrowIconRect,e.textRectFns.twowayArrow=R.twowayArrowTextRect,e.drawNodeFns.cloud=H.cloud,e.anchorsFns.cloud=U.cloudAnchors,e.iconRectFns.cloud=K.cloudIconRect,e.textRectFns.cloud=K.cloudTextRect,e.drawNodeFns.message=X.message,e.anchorsFns.message=G.messageAnchors,e.iconRectFns.message=Y.messageIconRect,e.textRectFns.message=Y.messageTextRect,e.drawNodeFns.file=J.file,e.drawNodeFns.text=d.text,e.iconRectFns.text=L.lineIconRect,e.drawNodeFns.line=f.line,e.anchorsFns.line=x.lineAnchors,e.iconRectFns.line=L.lineIconRect,e.textRectFns.line=L.lineTextRect,e.drawNodeFns.image=function(t,e){},e.iconRectFns.image=V.imageIconRect,e.textRectFns.image=V.imageTextRect,e.drawNodeFns.cube=Q.cube,e.anchorsFns.cube=Z.cubeAnchors,e.iconRectFns.cube=$.cubeIconRect,e.textRectFns.cube=$.cubeTextRect,e.drawNodeFns.people=tt.people,e.iconRectFns.people=et.peopleIconRect,e.textRectFns.people=et.peopleTextRect,e.drawLineFns.line={drawFn:T.line,drawControlPointsFn:T.lineControlPoints,controlPointsFn:T.calcLineControlPoints,pointIn:k.pointInPolyline},e.drawLineFns.polyline={drawFn:k.polyline,drawControlPointsFn:k.polylineControlPoints,controlPointsFn:k.calcPolylineControlPoints,dockControlPointFn:k.dockPolylineControlPoint,pointIn:k.pointInPolyline},e.drawLineFns.curve={drawFn:I.curve,drawControlPointsFn:I.curveControlPoints,controlPointsFn:I.calcCurveControlPoints,pointIn:I.pointInCurve},e.drawLineFns.mind={drawFn:I.curve,drawControlPointsFn:I.curveControlPoints,controlPointsFn:I.calcMindControlPoints,pointIn:I.pointInCurve},e.drawArrowFns.triangleSolid=M.triangleSolid,e.drawArrowFns.triangle=M.triangle,e.drawArrowFns.diamondSolid=S.diamondSolid,e.drawArrowFns.diamond=S.diamond,e.drawArrowFns.circleSolid=_.circleSolid,e.drawArrowFns.circle=_.circle,e.drawArrowFns.line=C.line,e.drawArrowFns.lineUp=C.lineUp,e.drawArrowFns.lineDown=C.lineDown,e.registerNode=function(t,n,r,o,c,h){return!(e.drawNodeFns[t]&&!h)&&(e.drawNodeFns[t]=n,e.anchorsFns[t]=r,e.iconRectFns[t]=o,e.textRectFns[t]=c,!0)},e.registerLine=function(t,n,r,o,c,h,l){return!(e.drawLineFns[t]&&!l)&&(e.drawLineFns[t]={drawFn:n,drawControlPointsFn:r,controlPointsFn:o,dockControlPointFn:c,pointIn:h},!0)},e.registerArrow=function(t,n,r){return!(e.drawArrowFns[t]&&!r)&&(e.drawArrowFns[t]=n,!0)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.circle=function(t,e){t.beginPath(),t.ellipse(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height/2,e.rect.width/2,e.rect.height/2,0,0,2*Math.PI),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.triangle=function(t,e){t.beginPath(),t.moveTo(e.rect.x+e.rect.width/2,e.rect.y),t.lineTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height),t.lineTo(e.rect.x,e.rect.y+e.rect.height),t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.diamond=function(t,e){t.beginPath(),t.moveTo(e.rect.x+e.rect.width/2,e.rect.y),t.lineTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height/2),t.lineTo(e.rect.x+e.rect.width/2,e.rect.y+e.rect.height),t.lineTo(e.rect.x,e.rect.y+e.rect.height/2),t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.leftArrow=function(t,e){t.beginPath(),t.moveTo(e.rect.x,e.rect.y+e.rect.height/2),t.lineTo(e.rect.x+e.rect.height/2,e.rect.y),t.lineTo(e.rect.x+e.rect.height/2,e.rect.y+e.rect.height/3),t.lineTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height/3),t.lineTo(e.rect.x+e.rect.width,e.rect.y+2*e.rect.height/3),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y+2*e.rect.height/3),t.lineTo(e.rect.x+e.rect.height/2,e.rect.y+2*e.rect.height/3),t.lineTo(e.rect.x+e.rect.height/2,e.rect.y+e.rect.height),t.closePath(),e.fillStyle&&t.fill(),t.stroke()},e.rightArrow=function(t,e){t.beginPath(),t.moveTo(e.rect.x,e.rect.y+e.rect.height/3),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y+e.rect.height/3),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y),t.lineTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height/2),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y+e.rect.height),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y+2*e.rect.height/3),t.lineTo(e.rect.x,e.rect.y+2*e.rect.height/3),t.closePath(),e.fillStyle&&t.fill(),t.stroke()},e.twowayArrow=function(t,e){t.beginPath(),t.moveTo(e.rect.x,e.rect.y+e.rect.height/2),t.lineTo(e.rect.x+e.rect.height/2,e.rect.y),t.lineTo(e.rect.x+e.rect.height/2,e.rect.y+e.rect.height/3),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y+e.rect.height/3),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y),t.lineTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height/2),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y+e.rect.height),t.lineTo(e.rect.x+(e.rect.width-e.rect.height/2),e.rect.y+2*e.rect.height/3),t.lineTo(e.rect.x+e.rect.height/2,e.rect.y+2*e.rect.height/3),t.lineTo(e.rect.x+e.rect.height/2,e.rect.y+e.rect.height),t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.line=function(t,e){t.beginPath();var n=e.rect.y+e.rect.height/2;t.moveTo(e.rect.x,n),t.lineTo(e.rect.x+e.rect.width,n),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.triangleAnchors=function(t){t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+3*t.rect.width/4,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height,o.Direction.Bottom)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/4,t.rect.y+t.rect.height/2,o.Direction.Left))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.arrowAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+t.rect.height/2,o.Direction.Right))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.lineAnchors=function(t){var e=t.rect.y+t.rect.height/2;t.anchors.push(new r.Point(t.rect.x,e,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,e,o.Direction.Right));for(var i=t.rect.x+5;i<t.rect.ex;i+=5){var n=new r.Point(i,e,o.Direction.Bottom);n.hidden=!0,t.anchors.push(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.circleIconRect=function(t){var e=t.rect.width/2,n=t.rect.height/2;e>n?e=n:n=e;var o=t.rect.height/10;o<10&&(o=10),t.iconRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+o,e,n)},e.circleTextRect=function(t){var e=t.rect.height/20;e<5&&(e=0),t.textRect=new r.Rect(t.rect.x+t.rect.width/4,t.rect.y+2*t.rect.height/3-e,t.rect.width/2,t.rect.height/3-5);var n=5*t.rect.width/7,o=5*t.rect.height/7;t.fullTextRect=new r.Rect(t.rect.x+(t.rect.width-n)/2,t.rect.y+(t.rect.height-o)/2,n,o)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.triangleIconRect=function(t){var e=2*t.rect.width/7,n=2*t.rect.height/7;e>n?e=n:n=e;var o=e;o<10&&(o=10),t.iconRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+o,e,n)},e.triangleTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.width/4,t.rect.y+2*t.rect.height/3,t.rect.width/2,t.rect.height/3-5);var e=t.rect.width/2,n=3*t.rect.height/7;t.fullTextRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+t.rect.height/2-5,e,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.diamondIconRect=function(t){var e=t.rect.width/3,n=t.rect.height/3;e>n?e=n:n=e;var o=t.rect.width/5;o<10&&(o=10),t.iconRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+o,e,n)},e.diamondTextRect=function(t){var e=t.rect.height/10;e<5&&(e=0),t.textRect=new r.Rect(t.rect.x+t.rect.width/3,t.rect.y+2*t.rect.height/3-e,t.rect.width/3,t.rect.height/3-5);var n=t.rect.width/2,o=1*t.rect.height/2;t.fullTextRect=new r.Rect(t.rect.x+(t.rect.width-n)/2,t.rect.y+t.rect.height/4,n,o)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.leftArrowIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.leftArrowTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.height/2,t.rect.y+t.rect.height/3,t.rect.width-t.rect.height/2,t.rect.height/3),t.fullTextRect=t.textRect},e.rightArrowIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.rightArrowTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y+t.rect.height/3,t.rect.width-t.rect.height/2,t.rect.height/3),t.fullTextRect=t.textRect},e.twowayArrowIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.twowayArrowTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.height/2,t.rect.y+t.rect.height/3,t.rect.width-t.rect.height,t.rect.height/3),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.lineIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.lineTextRect=function(t){t.fullTextRect=new r.Rect(t.rect.x+10,t.rect.y+t.rect.height/2-20,t.rect.width-20,20),t.textRect=t.fullTextRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.line=function(t,e){t.beginPath(),t.moveTo(e.from.x,e.from.y),t.lineTo(e.to.x,e.to.y),t.stroke()},e.lineControlPoints=function(t,e){},e.calcLineControlPoints=function(t){t.controlPoints=[]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319),c=n(326);function h(t,e){var n=t.clone();switch(t.direction){case o.Direction.Up:e.y<t.y?n.y-=Math.floor((t.y-e.y)/2):n.y-=50;break;case o.Direction.Right:e.x>t.x?n.x+=Math.floor((e.x-t.x)/2):n.x+=50;break;case o.Direction.Bottom:e.y>t.y?n.y+=Math.floor((e.y-t.y)/2):n.y+=50;break;case o.Direction.Left:e.x<t.x?n.x-=Math.floor((t.x-e.x)/2):n.x-=50}return n}function l(t,e){var n=t.x+(e.x-t.x)/2;return[new r.Point(n,t.y),new r.Point(n,e.y)]}function d(t,e){var n=t.y+(e.y-t.y)/2;return[new r.Point(t.x,n),new r.Point(e.x,n)]}e.polyline=function(t,e){t.beginPath(),t.moveTo(e.from.x,e.from.y);for(var n=0,r=e.controlPoints;n<r.length;n++){var o=r[n];t.lineTo(o.x,o.y)}t.lineTo(e.to.x,e.to.y),t.stroke()},e.polylineControlPoints=function(t,e){t.save(),t.fillStyle="#fff",t.lineWidth=2;for(var n=0,r=e.controlPoints;n<r.length;n++){var o=r[n];t.beginPath(),t.arc(o.x,o.y,4,0,2*Math.PI),t.stroke(),t.fill()}t.restore()},e.calcPolylineControlPoints=function(t){t.controlPoints=[];var e=h(t.from,t.to);t.from.direction&&t.controlPoints.push(e);var n,c=h(t.to,t.from);switch(e.direction){case o.Direction.Up:n=function(t,e){if(t.x===e.x||t.y===e.y)return[];if(t.y>e.y)return e.direction===o.Direction.Up&&t.y-e.y>150?t.x<e.x?e.x-t.x<50?[new r.Point(t.x-100,t.y),new r.Point(t.x-100,e.y)]:[new r.Point(t.x,e.y)]:t.x-e.x<50?[new r.Point(t.x+100,t.y),new r.Point(t.x+100,e.y)]:[new r.Point(t.x,e.y)]:e.direction===o.Direction.Left&&t.x>e.x||e.direction===o.Direction.Right&&t.x<e.x?[new r.Point(e.x,t.y)]:[new r.Point(t.x,e.y)];if(e.direction===o.Direction.Bottom){if(t.x<e.x)return l(t,e);var n=l(e,t);return[n[1],n[0]]}return[new r.Point(e.x,t.y)]}(e,c);break;case o.Direction.Right:n=function(t,e){if(t.x===e.x||t.y===e.y)return[];if(t.x<e.x)return e.direction===o.Direction.Right&&e.x-t.x>150?t.y<e.y?e.y-t.y<50?[new r.Point(t.x,t.y-100),new r.Point(e.x,t.y-100)]:[new r.Point(e.x,t.y)]:t.y-e.y<50?[new r.Point(t.x,t.y+100),new r.Point(e.x,t.y+100)]:[new r.Point(e.x,t.y)]:e.direction===o.Direction.Right||e.direction===o.Direction.Up&&t.y<e.y||e.direction===o.Direction.Bottom&&t.y>e.y?[new r.Point(e.x,t.y)]:[new r.Point(t.x,e.y)];if(e.direction===o.Direction.Left){if(t.y<e.y)return d(t,e);var n=d(e,t);return[n[1],n[0]]}return[new r.Point(t.x,e.y)]}(e,c);break;case o.Direction.Bottom:n=function(t,e){if(t.x===e.x||t.y===e.y)return[];if(t.y<e.y)return e.direction===o.Direction.Bottom&&e.y-t.y>150?t.x<e.x?e.x-t.x<50?[new r.Point(t.x-100,t.y),new r.Point(t.x-100,e.y)]:[new r.Point(t.x,e.y)]:t.x-e.x<50?[new r.Point(t.x+100,t.y),new r.Point(t.x+100,e.y)]:[new r.Point(t.x,e.y)]:e.direction===o.Direction.Left&&t.x>e.x||e.direction===o.Direction.Right&&t.x<e.x?[new r.Point(e.x,t.y)]:[new r.Point(t.x,e.y)];if(e.direction===o.Direction.Up){if(t.x<e.x)return l(t,e);var n=l(e,t);return[n[1],n[0]]}return[new r.Point(e.x,t.y)]}(e,c);break;case o.Direction.Left:n=function(t,e){if(t.x===e.x||t.y===e.y)return[];if(t.x>e.x)return e.direction===o.Direction.Left&&t.x-e.x>150?t.y<e.y?e.y-t.y<50?[new r.Point(t.x,t.y+100),new r.Point(e.x,t.y+100)]:[new r.Point(e.x,t.y)]:t.y-e.y<50?[new r.Point(t.x,t.y-100),new r.Point(e.x,t.y-100)]:[new r.Point(e.x,t.y)]:e.direction===o.Direction.Left||e.direction===o.Direction.Up&&t.y<e.y||e.direction===o.Direction.Bottom&&t.y>e.y?[new r.Point(e.x,t.y)]:[new r.Point(t.x,e.y)];if(e.direction===o.Direction.Right){if(t.y<e.y)return d(t,e);var n=d(e,t);return[n[1],n[0]]}return[new r.Point(t.x,e.y)]}(e,c)}t.controlPoints.push.apply(t.controlPoints,n),t.to.direction&&t.controlPoints.push(c)},e.pointInPolyline=function(t,e){if(!e.controlPoints||!e.controlPoints.length)return c.pointInLine(t,e.from,e.to);if(c.pointInLine(t,e.from,e.controlPoints[0]))return!0;if(c.pointInLine(t,e.to,e.controlPoints[e.controlPoints.length-1]))return!0;for(var i=0;i<e.controlPoints.length-1;++i)if(c.pointInLine(t,e.controlPoints[i],e.controlPoints[i+1]))return!0;return!1},e.dockPolylineControlPoint=function(t,e){var n=[e.from];n.push.apply(n,e.controlPoints),n.push(e.to);for(var r=0,o=n;r<o.length;r++){var c=o[r];Math.abs(t.x-c.x)<7&&(t.x=c.x),Math.abs(t.y-c.y)<7&&(t.y=c.y)}}},function(t,e,n){"use strict";function r(t,e,n,r,o){r+=3*t.lineWidth;var c=t.lineWidth/10;t.lineWidth<2&&(t.lineWidth=2,c=0),t.translate(n.x,n.y),t.rotate(Math.atan2(n.y-e.y,n.x-e.x)),t.translate(-n.x-t.lineWidth+5*c,-n.y),t.moveTo(n.x,n.y+c),t.lineTo(n.x,n.y-c),t.lineTo(n.x-r,n.y-r/3),t.lineTo(n.x-r,n.y+r/3),t.closePath(),t.stroke(),o&&(t.fillStyle=o),t.fill()}Object.defineProperty(e,"__esModule",{value:!0}),e.triangleSolid=r,e.triangle=function(t,e,n,o){r(t,e,n,o,"#fff")}},function(t,e,n){"use strict";function r(t,e,n,r,o){var c=(r+=3*t.lineWidth)/2,h=t.lineWidth/10;t.lineWidth<2&&(t.lineWidth=2,h=0),t.translate(n.x,n.y),t.rotate(Math.atan2(n.y-e.y,n.x-e.x)),t.translate(-n.x-t.lineWidth+5*h,-n.y),t.moveTo(n.x,n.y+h),t.lineTo(n.x,n.y-h),t.lineTo(n.x-c,n.y-c/2),t.lineTo(n.x-r,n.y-h),t.lineTo(n.x-r,n.y+h),t.lineTo(n.x-c,n.y+c/2),t.closePath(),t.stroke(),o&&(t.fillStyle=o),t.fill()}Object.defineProperty(e,"__esModule",{value:!0}),e.diamondSolid=r,e.diamond=function(t,e,n,o){r(t,e,n,o,"#fff")}},function(t,e,n){"use strict";function r(t,e,n,r,o){var c=(r+=3*t.lineWidth)/2;t.lineWidth<2&&(t.lineWidth=2),t.translate(n.x,n.y),t.rotate(Math.atan2(n.y-e.y,n.x-e.x)),t.translate(-n.x,-n.y-t.lineWidth/10),t.arc(n.x-c-t.lineWidth/2,n.y,c,0,2*Math.PI),t.stroke(),o&&(t.fillStyle=o),t.fill()}Object.defineProperty(e,"__esModule",{value:!0}),e.circleSolid=r,e.circle=function(t,e,n,o){r(t,e,n,o,"#fff")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.circleAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height,o.Direction.Bottom));for(var i=5;i<360;i+=5)if(i%90!=0){var e=Math.floor(i/90),n=new r.Point(t.rect.center.x+Math.sin(i/180*Math.PI)*t.rect.width/2,t.rect.center.y+Math.cos(i/180*Math.PI)*t.rect.height/2,e);n.hidden=!0,t.anchors.push(n)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.line=function(t,e,n,r){r+=3*t.lineWidth,t.translate(n.x,n.y),t.rotate(Math.atan2(n.y-e.y,n.x-e.x)),t.translate(-n.x-t.lineWidth/5,-n.y-t.lineWidth/5),t.moveTo(n.x,n.y),t.lineTo(n.x-r,n.y-r/3),t.moveTo(n.x,n.y),t.lineTo(n.x-r,n.y+r/3),t.stroke()},e.lineUp=function(t,e,n,r){r+=3*t.lineWidth,t.translate(n.x,n.y),t.rotate(Math.atan2(n.y-e.y,n.x-e.x)),t.translate(-n.x-t.lineWidth/5,-n.y-t.lineWidth/5),n.x>e.x?(t.moveTo(n.x,n.y),t.lineTo(n.x-r,n.y-r/3)):(t.moveTo(n.x,n.y),t.lineTo(n.x-r,n.y+r/3)),t.stroke()},e.lineDown=function(t,e,n,r){r+=3*t.lineWidth,t.translate(n.x,n.y),t.rotate(Math.atan2(n.y-e.y,n.x-e.x)),t.translate(-n.x-t.lineWidth/5,-n.y-t.lineWidth/5),n.x<e.x?(t.moveTo(n.x,n.y),t.lineTo(n.x-r,n.y-r/3)):(t.moveTo(n.x,n.y),t.lineTo(n.x-r,n.y+r/3)),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pentagon=function(t,e){t.beginPath(),t.moveTo(e.rect.x+e.rect.width/2,e.rect.y),t.lineTo(e.rect.x+e.rect.width,e.rect.y+2*e.rect.height/5),t.lineTo(e.rect.x+4*e.rect.width/5,e.rect.y+e.rect.height),t.lineTo(e.rect.x+e.rect.width/5,e.rect.y+e.rect.height),t.lineTo(e.rect.x,e.rect.y+2*e.rect.height/5),t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.pentagonIconRect=function(t){var e=t.rect.width/2,n=t.rect.height/2;e>n?e=n:n=e;var o=t.rect.height/7;o<10&&(o=10),t.iconRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+o,e,n)},e.pentagonTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.width/5,t.rect.y+5*t.rect.height/7,3*t.rect.width/5,t.rect.height/4);var e=3*t.rect.width/5,n=3*t.rect.height/5;t.fullTextRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+t.rect.height/4,e,n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.pentagonAnchors=function(t){t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+2*t.rect.height/5,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+4*t.rect.width/5,t.rect.y+t.rect.height,o.Direction.Bottom)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/5,t.rect.y+t.rect.height,o.Direction.Bottom)),t.anchors.push(new r.Point(t.rect.x,t.rect.y+2*t.rect.height/5,o.Direction.Left))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.hexagon=function(t,e){t.beginPath();var n=e.rect.width/5;t.moveTo(e.rect.x+n,e.rect.y),t.lineTo(e.rect.x+e.rect.width-n,e.rect.y),t.lineTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height/2),t.lineTo(e.rect.x+e.rect.width-n,e.rect.y+e.rect.height),t.lineTo(e.rect.x+n,e.rect.y+e.rect.height),t.lineTo(e.rect.x,e.rect.y+e.rect.height/2),t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.hexagonAnchors=function(t){t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height,o.Direction.Bottom)),t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left));var e=new r.Point(t.rect.x+t.rect.width/10,t.rect.y+t.rect.height/4,o.Direction.Left);e.hidden=!0,t.anchors.push(e);var n=new r.Point(t.rect.x+t.rect.width/10,t.rect.y+3*t.rect.height/4,o.Direction.Left);n.hidden=!0,t.anchors.push(n);var c=new r.Point(t.rect.x+9*t.rect.width/10,t.rect.y+t.rect.height/4,o.Direction.Right);c.hidden=!0,t.anchors.push(c);var h=new r.Point(t.rect.x+9*t.rect.width/10,t.rect.y+3*t.rect.height/4,o.Direction.Right);h.hidden=!0,t.anchors.push(h)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.hexagonIconRect=function(t){var e=3*t.rect.width/5,n=3*t.rect.height/4;t.iconRect=new r.Rect(t.rect.x+t.rect.width/5+t.paddingLeftNum,t.rect.y+t.paddingTopNum,e-t.paddingLeftNum-t.paddingRightNum,n-t.paddingTopNum-t.paddingBottomNum),t.fullIconRect=new r.Rect(t.rect.x+t.rect.width/5+t.paddingLeftNum,t.rect.y+t.paddingTopNum,e-t.paddingLeftNum-t.paddingRightNum,t.rect.height-t.paddingTopNum-t.paddingBottomNum)},e.hexagonTextRect=function(t){var e=3*t.rect.width/5,n=t.rect.height/4;t.textRect=new r.Rect(t.rect.x+t.rect.width/5+t.paddingLeftNum,t.rect.y+t.rect.height-n+t.paddingTopNum,e-t.paddingLeftNum-t.paddingRightNum,n),t.fullTextRect=new r.Rect(t.rect.x+t.rect.width/5+t.paddingLeftNum,t.rect.y+t.paddingTopNum,e-t.paddingLeftNum-t.paddingRightNum,t.rect.height-t.paddingTopNum-t.paddingBottomNum)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pentagram=function(t,e){t.beginPath();for(var i=0;i<5;++i)t.lineTo(Math.cos((18+72*i)/180*Math.PI)*e.rect.width/2+e.rect.x+e.rect.width/2,-Math.sin((18+72*i)/180*Math.PI)*e.rect.width/2+e.rect.y+e.rect.height/2),t.lineTo(Math.cos((54+72*i)/180*Math.PI)*e.rect.width/4+e.rect.x+e.rect.width/2,-Math.sin((54+72*i)/180*Math.PI)*e.rect.width/4+e.rect.y+e.rect.height/2);t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.pentagramAnchors=function(t){t.anchors.push(new r.Point(Math.cos(.1*Math.PI)*t.rect.width/2+t.rect.x+t.rect.width/2,-Math.sin(.1*Math.PI)*t.rect.width/2+t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(Math.cos(.5*Math.PI)*t.rect.width/2+t.rect.x+t.rect.width/2,-Math.sin(.5*Math.PI)*t.rect.width/2+t.rect.y+t.rect.height/2,o.Direction.Up)),t.anchors.push(new r.Point(Math.cos(.9*Math.PI)*t.rect.width/2+t.rect.x+t.rect.width/2,-Math.sin(.9*Math.PI)*t.rect.width/2+t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(Math.cos(1.3*Math.PI)*t.rect.width/2+t.rect.x+t.rect.width/2,-Math.sin(1.3*Math.PI)*t.rect.width/2+t.rect.y+t.rect.height/2,o.Direction.Bottom)),t.anchors.push(new r.Point(Math.cos(1.7*Math.PI)*t.rect.width/2+t.rect.x+t.rect.width/2,-Math.sin(1.7*Math.PI)*t.rect.width/2+t.rect.y+t.rect.height/2,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.pentagramIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.pentagramTextRect=function(t){var e=2*t.rect.width/5,n=2*t.rect.height/5;t.fullTextRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+(t.rect.height-n)/2,e,n),t.textRect=t.fullTextRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cloud=function(t,e){t.beginPath(),t.moveTo(e.rect.x+e.rect.width/5,e.rect.y+13*e.rect.height/16),t.bezierCurveTo(e.rect.x-e.rect.width/15,e.rect.y+13*e.rect.height/16,e.rect.x-e.rect.width/15,e.rect.y+7*e.rect.height/16,e.rect.x+e.rect.width/5,e.rect.y+7*e.rect.height/16),t.bezierCurveTo(e.rect.x+e.rect.width/5,e.rect.y,e.rect.x+4*e.rect.width/5,e.rect.y,e.rect.x+4*e.rect.width/5,e.rect.y+7*e.rect.height/16),t.bezierCurveTo(e.rect.x+16*e.rect.width/15,e.rect.y+7*e.rect.height/16,e.rect.x+16*e.rect.width/15,e.rect.y+13*e.rect.height/16,e.rect.x+4*e.rect.width/5,e.rect.y+13*e.rect.height/16),t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.cloudAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+3*t.rect.height/5,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/9,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+3*t.rect.height/5,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+4*t.rect.height/5,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.cloudIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.cloudTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.width/4,t.rect.y+t.rect.height/4,t.rect.width/2,6*t.rect.height/11),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.message=function(t,e){t.beginPath(),t.moveTo(e.rect.x,e.rect.y),t.lineTo(e.rect.x+e.rect.width,e.rect.y),t.lineTo(e.rect.x+e.rect.width,e.rect.y+3*e.rect.height/4),t.lineTo(e.rect.x+8*e.rect.width/16,e.rect.y+3*e.rect.height/4),t.lineTo(e.rect.x+e.rect.width/4,e.rect.ey),t.lineTo(e.rect.x+5*e.rect.width/16,e.rect.y+3*e.rect.height/4),t.lineTo(e.rect.x,e.rect.y+3*e.rect.height/4),t.closePath(),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.messageIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0),t.fullIconRect=t.iconRect},e.messageTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.paddingLeftNum,t.rect.y+t.paddingTopNum,t.rect.width-t.paddingLeftNum-t.paddingRightNum,3*t.rect.height/4-t.paddingTopNum-t.paddingBottomNum),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.messageAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+3*t.rect.height/8,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+3*t.rect.height/8,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/4,t.rect.ey,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.file=function(t,e){t.beginPath();var n=e.rect.width/6;t.moveTo(e.rect.x,e.rect.y),t.lineTo(e.rect.ex-n,e.rect.y),t.lineTo(e.rect.ex,e.rect.y+n),t.lineTo(e.rect.ex,e.rect.ey),t.lineTo(e.rect.x,e.rect.ey),t.closePath(),t.moveTo(e.rect.ex-n,e.rect.y),t.lineTo(e.rect.ex-n,e.rect.y+n),t.lineTo(e.rect.ex,e.rect.y+n),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317),o=n(331),c=n(320);function h(t){var e=30;return t.image?t.imageHeight>0&&(e=t.imageHeight):t.icon&&t.iconSize>0&&(e=t.iconSize),e}e.imageIconRect=function(t){var e=t.rect.x,n=t.rect.y,o=t.rect.width;t.imageWidth&&(o=t.imageWidth,e+=(t.rect.width-o)/2);var c=t.rect.height-t.textRect.height-5;c<30&&(c=30);var l=h(t);if(30!==l){c=l;var d=t.rect.ey-t.textRect.y;d<0&&(d=0),n+=(t.rect.height-d-c)/2}t.iconRect=new r.Rect(e,n,o,c),t.textRect.y=t.iconRect.ey+5,t.textRect.ey=t.textRect.y+t.textRect.height,t.fullIconRect=t.rect},e.imageTextRect=function(t){var e=0,n=t.font.fontSize*t.font.lineHeight;if(t.textMaxLine)e=n*t.textMaxLine;else{var canvas=c.Store.get("LT:offscreen");e=n*o.getLines(canvas.getContext("2d"),o.getWords(t.text),t.rect.width,t.font.fontSize).length}var l=t.rect.ey-e,d=h(t);l-d-5<t.rect.y&&(l=t.rect.y+d+5),t.textRect=new r.Rect(t.rect.x,l,t.rect.width,e),t.fullTextRect=t.rect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(397);e.cube=function(t,e){new r.Cube(e.rect,e.z,e.zRotate,e.fillStyle,e.strokeStyle).render(t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(333),c=function(){function t(t,e,n,r,o,c){void 0===o&&(o=""),void 0===c&&(c=""),this.points=[],this.fillStyle="",this.strokeStyle="",this.points.push(t),this.points.push(e),this.points.push(n),this.points.push(r),this.fillStyle=o,this.strokeStyle=c||o}return t.prototype.render=function(t){t.save(),t.fillStyle=this.fillStyle,t.strokeStyle=this.strokeStyle,t.beginPath();for(var i=0;i<this.points.length;++i)i?t.lineTo(this.points[i].x,this.points[i].y):t.moveTo(this.points[i].x,this.points[i].y);t.closePath(),this.fillStyle&&t.fill(),t.stroke(),t.restore()},t}();e.Surface=c;var h=function(){function t(rect,t,e,n,h){void 0===n&&(n="#ddd"),void 0===h&&(h="#ccc"),this.surfaces=[];var l=t*Math.sin(45*Math.PI/180),d=new r.Point(rect.x,rect.y+l),f=new r.Point(rect.ex-l,rect.y+l),y=new r.Point(rect.ex-l,rect.ey),v=new r.Point(rect.x,rect.ey);this.surfaces.push(new c(d,f,y,v,n,h)),this.surfaces.push(new c(d,new r.Point(rect.x+l,rect.y),new r.Point(rect.ex,rect.y),f,o.pSBC(.5,n),h)),this.surfaces.push(new c(f,new r.Point(rect.ex,rect.y),new r.Point(rect.ex,rect.ey-l),y,o.pSBC(.6,n),h))}return t.prototype.render=function(t){for(var e=0,n=this.surfaces;e<n.length;e++){n[e].render(t)}},t}();e.Cube=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.cubeAnchors=function(t){var e=t.z*Math.sin(45*Math.PI/180);t.anchors.push(new r.Point(t.rect.x,t.rect.ey-(t.rect.height-e)/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+e/2,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.ex-e/2,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+(t.rect.width-e)/2,t.rect.y+t.rect.height,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.cubeIconRect=function(t){t.fullIconRect=t.fullTextRect,t.iconRect=new r.Rect(t.fullIconRect.x,t.fullIconRect.y,t.fullIconRect.width,2*t.fullIconRect.height/3)},e.cubeTextRect=function(t){var e=t.z*Math.sin(45*Math.PI/180);t.fullTextRect=new r.Rect(t.rect.x,t.rect.y+e,t.rect.width-e,t.rect.height-e),t.textRect=new r.Rect(t.fullTextRect.x+10,t.fullTextRect.y+2*t.fullTextRect.height/3,t.fullTextRect.width-20,t.fullTextRect.height/3-5)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.people=function(t,e){t.beginPath();var n=e.rect.width/4,r=e.rect.x+e.rect.width/2;t.arc(r,e.rect.y+n,n,0,2*Math.PI),t.moveTo(e.rect.x,e.rect.y+3*n),t.lineTo(e.rect.ex,e.rect.y+3*n),t.moveTo(r,e.rect.y+2*n),t.lineTo(r,e.rect.y+4*n),t.moveTo(r,e.rect.y+4*n),t.lineTo(e.rect.x,e.rect.ey),t.moveTo(r,e.rect.y+4*n),t.lineTo(e.rect.ex,e.rect.ey),e.fillStyle&&t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.peopleIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.peopleTextRect=function(t){t.textRect=new r.Rect(0,0,0,0),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.rectangleIconRect=function(t){t.iconRect=new r.Rect(t.rect.x+t.paddingLeftNum,t.rect.y+t.paddingTopNum,t.rect.height-t.paddingTopNum-t.paddingBottomNum,t.rect.height-t.paddingTopNum-t.paddingBottomNum),t.fullIconRect=new r.Rect(t.rect.x+t.paddingLeftNum,t.rect.y+t.paddingTopNum,t.rect.width-t.paddingLeftNum-t.paddingRightNum,t.rect.height-t.paddingTopNum-t.paddingBottomNum)},e.rectangleTextRect=function(t){var e=t.rect.height-t.paddingTopNum-t.paddingBottomNum;t.textRect=new r.Rect(t.rect.x+t.paddingLeftNum+e,t.rect.y+t.paddingTopNum,t.rect.width-t.paddingLeftNum-t.paddingRightNum-e,e),t.fullTextRect=new r.Rect(t.rect.x+t.paddingLeftNum,t.rect.y+t.paddingTopNum,t.rect.width-t.paddingLeftNum-t.paddingRightNum,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.defaultAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.defaultIconRect=function(t){t.iconRect=new r.Rect(t.rect.x+t.paddingLeftNum,t.rect.y+t.paddingTopNum,t.rect.width-t.paddingLeftNum-t.paddingRightNum,3*t.rect.height/4-t.paddingTopNum-t.paddingBottomNum),t.fullIconRect=new r.Rect(t.rect.x+t.paddingLeftNum,t.rect.y+t.paddingTopNum,t.rect.width-t.paddingLeftNum-t.paddingRightNum,t.rect.height-t.paddingTopNum-t.paddingBottomNum)},e.defaultTextRect=function(t){var e=t.rect.height-t.paddingTopNum-t.paddingBottomNum;t.textRect=new r.Rect(t.rect.x+t.paddingLeftNum,t.rect.y+t.paddingTopNum+3*e/4,t.rect.width-t.paddingLeftNum-t.paddingRightNum,e/4),t.fullTextRect=new r.Rect(t.rect.x+t.paddingLeftNum,t.rect.y+t.paddingTopNum,t.rect.width-t.paddingLeftNum-t.paddingRightNum,e)}},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)},function(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var c=n(320),h=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,e,n)||this;return r.parentElem=e,r.options=n,r.activeLayer=c.Store.get("LT:ActiveLayer"),r.hoverLayer=c.Store.get("LT:HoverLayer"),r.animateLayer=c.Store.get("LT:AnimateLayer"),c.Store.set("LT:offscreen",r.canvas),r}return o(e,t),e.prototype.render=function(){t.prototype.render.call(this);var e=this.canvas.getContext("2d");e.strokeStyle=this.options.color;for(var n=0,r=this.data.pens;n<r.length;n++){r[n].render(e)}this.activeLayer.render(e),this.animateLayer.render(e),this.hoverLayer.render(e)},e}(n(346).Canvas);e.Offscreen=h},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,b){t.__proto__=b}||function(t,b){for(var p in b)b.hasOwnProperty(p)&&(t[p]=b[p])})(t,b)},function(t,b){function e(){this.constructor=t}r(t,b),t.prototype=null===b?Object.create(b):(e.prototype=b.prototype,new e)});Object.defineProperty(e,"__esModule",{value:!0});var c=n(320),h=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,e,n)||this;return r.parentElem=e,r.options=n,r.offscreen=c.Store.get("LT:offscreen"),r.render=function(){if(!r.data.bkImage||r.bkImgRect){if(r.width&&r.height&&r.offscreen){var t=r.canvas.getContext("2d");t.clearRect(0,0,r.canvas.width,r.canvas.height),r.data.bkColor&&(t.fillStyle=r.data.bkColor,t.fillRect(0,0,r.width,r.height)),r.bkImg&&r.bkImgRect&&t.drawImage(r.bkImg,r.bkImgRect.x,r.bkImgRect.y,r.bkImgRect.width,r.bkImgRect.height,0,0,r.width,r.height),t.drawImage(r.offscreen,0,0,r.width,r.height)}}else r.loadBkImg(r.render)},r.parentElem.appendChild(r.canvas),r}return o(e,t),e.prototype.loadBkImg=function(t){var e=this;this.data.bkImage&&(this.bkImg=new Image,this.bkImg.crossOrigin="anonymous",this.bkImg.src=this.data.bkImage,this.bkImg.onload=function(){e.bkImgRect=e.coverRect(e.canvas.width,e.canvas.height,e.bkImg.width,e.bkImg.height),t&&t()})},e.prototype.clearBkImg=function(){this.bkImgRect=null},e.prototype.coverRect=function(t,e,n,r){var o=0,c=0,h=n,l=r;return n>r||n===r&&t<e?o=(n-(h=t*l/e))/2:(n<r||n===r&&t>e)&&(c=(r-(l=e*h/t))/2),{x:o,y:c,width:h,height:l}},e}(n(346).Canvas);e.RenderLayer=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(321),c=n(320),h=n(329),l=function(){function t(t){void 0===t&&(t={}),this.options=t,this.data=c.Store.get("topology-data"),this.anchorRadius=4,this.hoverAnchorIndex=-1,this.dockLineX=0,this.dockLineY=0,c.Store.set("LT:HoverLayer",this)}return t.prototype.lineTo=function(t,e){void 0===e&&(e="triangleSolid"),this.line&&!this.line.locked&&(this.line.setTo(t,e),(this.line.from.id||this.line.to.id)&&this.line.calcControlPoints(),c.Store.set("pts-"+this.line.id,null),c.Store.set("LT:updateLines",[this.line]))},t.prototype.lineFrom=function(t){this.line.locked||(this.line.setFrom(t,this.line.fromArrow),(this.line.from.id||this.line.to.id)&&this.line.calcControlPoints(),c.Store.set("pts-"+this.line.id,null),c.Store.set("LT:updateLines",[this.line]))},t.prototype.lineMove=function(t,e){if(!this.line.locked){var n=t.x-e.x,o=t.y-e.y;this.line.setTo(new r.Point(this.initLine.to.x+n,this.initLine.to.y+o),this.line.toArrow),this.line.setFrom(new r.Point(this.initLine.from.x+n,this.initLine.from.y+o),this.line.fromArrow);for(var i=0;i<this.initLine.controlPoints.length;++i)this.line.controlPoints[i].x=this.initLine.controlPoints[i].x+n,this.line.controlPoints[i].y=this.initLine.controlPoints[i].y+o;c.Store.set("pts-"+this.line.id,null),c.Store.set("LT:updateLines",[this.line])}},t.prototype.render=function(t){if(this.data.locked!==h.Lock.NoEvent){if(t.save(),t.strokeStyle=this.options.hoverColor,t.fillStyle="#fff",this.node&&!this.data.locked&&(this.root=this.getRoot(this.node)||this.node,this.root&&(t.save(),t.strokeStyle=this.options.dragColor,t.globalAlpha=.2,this.root.rotate&&(t.translate(this.root.rect.center.x,this.root.rect.center.y),t.rotate((this.root.rotate+this.root.offsetRotate)*Math.PI/180),t.translate(-this.root.rect.center.x,-this.root.rect.center.y)),t.beginPath(),t.strokeRect(this.root.rect.x,this.root.rect.y,this.root.rect.width,this.root.rect.height),t.restore()),!this.options.hideAnchor))for(var i=0;i<this.node.rotatedAnchors.length;++i)this.node.locked||this.node.hideAnchor||this.node.rotatedAnchors[i].hidden&&this.hoverAnchorIndex!==i||(t.beginPath(),t.arc(this.node.rotatedAnchors[i].x,this.node.rotatedAnchors[i].y,this.anchorRadius,0,2*Math.PI),t.fill(),t.stroke());if(t.fillStyle=this.options.hoverColor,this.dockAnchor&&(t.beginPath(),t.arc(this.dockAnchor.x,this.dockAnchor.y,4,0,2*Math.PI),t.fill()),this.hoverLineCP&&(t.beginPath(),t.arc(this.hoverLineCP.x,this.hoverLineCP.y,5,0,2*Math.PI),t.fill()),t.strokeStyle=this.options.hoverColor+"80",t.lineWidth=1,this.dockLineX>0){var e=c.Store.get("LT:size");t.beginPath(),t.moveTo(this.dockLineX,0),t.lineTo(this.dockLineX,e.height),t.stroke()}if(this.dockLineY>0){e=c.Store.get("LT:size");t.beginPath(),t.moveTo(0,this.dockLineY),t.lineTo(e.width,this.dockLineY),t.stroke()}this.dragRect&&(t.fillStyle=this.options.dragColor+"30",t.strokeStyle=this.options.dragColor,t.beginPath(),t.strokeRect(this.dragRect.x,this.dragRect.y,this.dragRect.width,this.dragRect.height),t.fillRect(this.dragRect.x,this.dragRect.y,this.dragRect.width,this.dragRect.height)),t.restore()}},t.prototype.getRoot=function(t){if(!t.parentId)return null;for(var e=0,n=this.data.pens;e<n.length;e++){var r=n[e];if(r instanceof o.Node&&r.id===t.parentId){var c=this.getRoot(r);return c||r}}return null},t.prototype.clear=function(){this.node=null,this.line=null},t}();e.HoverLayer=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(320),o=n(325),c=n(321),h=n(324),l=n(317),d=n(318),f=n(329),y=n(327),v=n(344),x=n(332),m=function(){function t(t){void 0===t&&(t={}),this.options=t,this.data=r.Store.get("topology-data"),this.rotateCPs=[],this.sizeCPs=[],this.pens=[],this.rotate=0,this.initialSizeCPs=[],this.nodeRects=[],this.childrenRects={},this.childrenRotate={},this.dockWatchers=[],this.rotating=!1,r.Store.set("LT:ActiveLayer",this)}return t.prototype.calcControlPoints=function(){if(1===this.pens.length&&this.pens[0]instanceof c.Node){if(this.rect=this.pens[0].rect,this.sizeCPs=this.pens[0].rect.toPoints(),this.rotateCPs=[new d.Point(this.pens[0].rect.x+this.pens[0].rect.width/2,this.pens[0].rect.y-35),new d.Point(this.pens[0].rect.x+this.pens[0].rect.width/2,this.pens[0].rect.y)],this.rotate||this.pens[0].rotate){for(var t=0,e=this.sizeCPs;t<e.length;t++){var n=e[t];this.pens[0].rotate&&n.rotate(this.pens[0].rotate,this.pens[0].rect.center),this.rotate&&n.rotate(this.rotate,this.rect.center)}for(var r=0,o=this.rotateCPs;r<o.length;r++){n=o[r];this.pens[0].rotate&&n.rotate(this.pens[0].rotate,this.pens[0].rect.center),this.rotate&&n.rotate(this.rotate,this.rect.center)}}(this.options.hideRotateCP||this.pens[0].hideRotateCP)&&(this.rotateCPs=[new d.Point(-1e3,-1e3),new d.Point(-1e3,-1e3)])}else{for(var h=99999,f=99999,y=-99999,v=-99999,x=0,m=this.getPoints();x<m.length;x++){var w=m[x];h>w.x&&(h=w.x),f>w.y&&(f=w.y),y<w.x&&(y=w.x),v<w.y&&(v=w.y)}this.rect=new l.Rect(h,f,y-h,v-f),this.sizeCPs=[new d.Point(h,f),new d.Point(y,f),new d.Point(y,v),new d.Point(h,v)],this.rotateCPs=[new d.Point(h+(y-h)/2,f-35),new d.Point(h+(y-h)/2,f)],this.options.hideRotateCP&&(this.rotateCPs=[new d.Point(-1e3,-1e3),new d.Point(-1e3,-1e3)])}},t.prototype.locked=function(){for(var t=0,e=this.pens;t<e.length;t++){if(!e[t].locked)return!1}return!0},t.prototype.getPoints=function(){for(var t=[],e=0,n=this.pens;e<n.length;e++){var r=n[e];if(r.type===o.PenType.Node){var c=r.rect.toPoints();if(r.rotate)for(var l=0,d=c;l<d.length;l++){d[l].rotate(r.rotate,r.rect.center)}t.push.apply(t,c)}else if(r instanceof h.Line&&(t.push(r.from),t.push(r.to),"curve"===r.name))for(var i=.01;i<1;i+=.02)t.push(x.getBezierPoint(i,r.from,r.controlPoints[0],r.controlPoints[1],r.to))}return t},t.prototype.clear=function(){this.pens=[],this.sizeCPs=[],this.rotateCPs=[],r.Store.set("LT:activeNode",null)},t.prototype.saveNodeRects=function(){this.nodeRects=[],this.childrenRects={};for(var t=0,e=this.pens;t<e.length;t++){var n=e[t];this.nodeRects.push(new l.Rect(n.rect.x,n.rect.y,n.rect.width,n.rect.height)),this.saveChildrenRects(n)}this.initialSizeCPs=[];for(var r=0,o=this.sizeCPs;r<o.length;r++){n=o[r];this.initialSizeCPs.push(n.clone())}this.getDockWatchers()},t.prototype.saveChildrenRects=function(t){if(t instanceof c.Node&&t.children)for(var e=0,n=t.children;e<n.length;e++){var r=n[e];this.childrenRects[r.id]=new l.Rect(r.rect.x,r.rect.y,r.rect.width,r.rect.height),this.childrenRotate[r.id]=r.rotate,this.saveChildrenRects(r)}},t.prototype.resize=function(t,e,n){var r=new d.Point(e.x,e.y),c=new d.Point(n.x,n.y);1===this.pens.length&&this.pens[0].rotate%360&&(r.rotate(-this.pens[0].rotate,this.nodeRects[0].center),c.rotate(-this.pens[0].rotate,this.nodeRects[0].center));var h=c.x-r.x,l=c.y-r.y;switch(t){case 0:h=-h,l=-l;break;case 1:l=-l;break;case 3:h=-h}for(var i=0,f=0,y=this.pens;f<y.length;f++){var v=y[f];if(!v.locked){switch(v.type){case o.PenType.Line:break;default:switch(v.rect.width=this.nodeRects[i].width+h,v.rect.height=this.nodeRects[i].height+l,v.rect.width<10&&(v.rect.width=10),v.rect.height<10&&(v.rect.height=10),t){case 0:v.rect.x=v.rect.ex-v.rect.width,v.rect.y=v.rect.ey-v.rect.height;break;case 1:v.rect.ex=v.rect.x+v.rect.width,v.rect.y=v.rect.ey-v.rect.height;break;case 2:v.rect.ex=v.rect.x+v.rect.width,v.rect.ey=v.rect.y+v.rect.height;break;case 3:v.rect.x=v.rect.ex-v.rect.width,v.rect.ey=v.rect.y+v.rect.height}v.rect.calcCenter(),v.init(),v.calcChildrenRect()}++i}}this.updateLines()},t.prototype.move=function(t,e){if(this.nodeRects.length===this.pens.length){for(var i=0,n=0,r=this.pens;n<r.length;n++){var o=r[n];if(!o.locked){if(o instanceof c.Node){var l=this.nodeRects[i].x+t-o.rect.x,d=this.nodeRects[i].y+e-o.rect.y;o.translate(l,d);for(var f=0,y=this.getLinesOfNode(o);f<y.length;f++){y[f].translate(l,d)}if(o.calcChildrenRect(),o.parentId&&!o.locked)for(var v=void 0,x=0,m=this.data.pens;x<m.length;x++){var w=m[x];if(w.id===o.parentId){v=w,o.calcRectInParent(v);break}}}h.Line,++i}}this.updateLines(),this.options.on&&this.options.on("move",this.pens)}},t.prototype.getLinesOfNode=function(t){for(var e=[],n=v.flatNodes([t]),r=0,o=this.data.pens;r<o.length;r++){var c=o[r];if(c instanceof h.Line){for(var line=c,l=!1,d=!1,f=0,y=n;f<y.length;f++){var x=y[f];line.from.id===x.id&&(l=!0),line.to.id===x.id&&(d=!0)}l&&d&&e.push(line)}}return e},t.prototype.updateLines=function(t){t||(t=this.pens);for(var e=v.flatNodes(t),n=[],o=0,c=this.data.pens;o<c.length;o++){var line=c[o];if(line instanceof h.Line)for(var l=0,d=e;l<d.length;l++){var f=d[l],y=0;line.from.id===f.id&&(line.from.x=f.rotatedAnchors[line.from.anchorIndex].x,line.from.y=f.rotatedAnchors[line.from.anchorIndex].y,++y),line.to.id===f.id&&(line.to.x=f.rotatedAnchors[line.to.anchorIndex].x,line.to.y=f.rotatedAnchors[line.to.anchorIndex].y,++y),y&&line.calcControlPoints(),line.textRect=null,r.Store.set("pts-"+line.id,null),n.push(line)}}r.Store.set("LT:updateLines",n)},t.prototype.offsetRotate=function(t){this.rotating=!0;for(var i=0,e=0,n=this.pens;e<n.length;e++){var r=n[e];if(r instanceof c.Node){var o=this.nodeRects[i].center.clone();this.pens.length>1&&o.rotate(t,this.rect.center),r.rect.x=o.x-r.rect.width/2,r.rect.y=o.y-r.rect.height/2,r.rect.ex=r.rect.x+r.rect.width,r.rect.ey=r.rect.y+r.rect.height,r.rect.calcCenter(),r.init(),r.offsetRotate=t,r.calcRotateAnchors(r.rotate+r.offsetRotate),this.rotateChildren(r),++i}}this.rotate=t,this.options.on&&this.options.on("rotated",this.pens)},t.prototype.rotateChildren=function(t){if(t.type===o.PenType.Node&&t.children)for(var e=0,n=t.children;e<n.length;e++){var r=n[e];if(r.type===o.PenType.Node){var c=this.childrenRects[r.id].center.clone(),h=this.childrenRects[r.id].center.clone().rotate(this.rotate,this.rect.center),rect=this.childrenRects[r.id].clone();rect.translate(h.x-c.x,h.y-c.y),r.rect=rect,r.rotate=this.childrenRotate[r.id]+this.rotate,r.init(),this.rotateChildren(r)}}},t.prototype.updateRotate=function(){for(var t=0,e=this.pens;t<e.length;t++){var n=e[t];n.rotate+=n.offsetRotate,n.offsetRotate=0}this.rotate=0,this.rotating=!1},t.prototype.add=function(t){this.has(t)||(this.pens.push(t),t instanceof c.Node&&r.Store.set("LT:activeNode",t))},t.prototype.setPens=function(t){this.pens=t,1===this.pens.length&&this.pens[0]instanceof c.Node&&r.Store.set("LT:activeNode",this.pens[0])},t.prototype.has=function(t){for(var e=0,n=this.pens;e<n.length;e++){if(n[e].id===t.id)return!0}},t.prototype.hasInAll=function(t,e){e||(e=this.pens);for(var n=0,r=e;n<r.length;n++){var o=r[n];if(o.id===t.id)return!0;if(o.children)if(this.hasInAll(t,o.children))return!0}},t.prototype.render=function(t){if(!(this.data.locked>f.Lock.Readonly)&&this.pens.length){1!==this.pens.length&&this.rotating||this.calcControlPoints(),t.save(),t.strokeStyle=this.options.activeColor,t.fillStyle="#fff",t.lineWidth=1;for(var e=0,n=this.pens;e<n.length;e++){if((x=n[e])instanceof c.Node)(r=new c.Node(x,!0)).data=null,r.fillStyle=null,r.bkType=0,r.icon="",r.image="",r.text="","transparent"!==r.strokeStyle&&(r.strokeStyle="#ffffff",r.lineWidth+=2,r.render(t),r.strokeStyle=this.options.activeColor,r.lineWidth-=2),r.render(t);if(x instanceof h.Line){var r;if((r=new h.Line(x)).lineWidth<3){var l=new h.Line(x);l.strokeStyle="#ffffff",l.render(t)}r.strokeStyle=this.options.activeColor,r.fromArrowColor=this.options.activeColor,r.toArrowColor=this.options.activeColor,r.render(t),x.locked||y.drawLineFns[x.name].drawControlPointsFn(t,x)}}if(1!==this.pens.length||this.pens[0].type!==o.PenType.Line)if(this.rotate&&this.pens.length>1&&(t.translate(this.rect.center.x,this.rect.center.y),t.rotate(this.rotate*Math.PI/180),t.translate(-this.rect.center.x,-this.rect.center.y)),t.save(),t.globalAlpha=.3,t.translate(.5,.5),t.beginPath(),t.moveTo(this.sizeCPs[0].x,this.sizeCPs[0].y),t.lineTo(this.sizeCPs[1].x,this.sizeCPs[1].y),t.lineTo(this.sizeCPs[2].x,this.sizeCPs[2].y),t.lineTo(this.sizeCPs[3].x,this.sizeCPs[3].y),t.closePath(),t.stroke(),t.restore(),this.data.locked||this.locked())t.restore();else{if(t.beginPath(),t.moveTo(this.rotateCPs[0].x,this.rotateCPs[0].y),t.lineTo(this.rotateCPs[1].x,this.rotateCPs[1].y),t.stroke(),t.beginPath(),t.arc(this.rotateCPs[0].x,this.rotateCPs[0].y,5,0,2*Math.PI),t.fill(),t.stroke(),!this.options.hideSizeCP&&(this.pens.length>1||!this.pens[0].hideSizeCP)){t.lineWidth=1;for(var d=0,v=this.sizeCPs;d<v.length;d++){var x=v[d];t.save(),t.beginPath(),1===this.pens.length&&(this.pens[0].rotate||this.rotate)&&(t.translate(x.x,x.y),t.rotate((this.pens[0].rotate+this.rotate)*Math.PI/180),t.translate(-x.x,-x.y)),t.fillRect(x.x-4.5,x.y-4.5,8,8),t.strokeRect(x.x-5.5,x.y-5.5,10,10),t.restore()}}t.restore()}}},t.prototype.getDockWatchers=function(){if(1===this.pens.length)return this.dockWatchers=this.nodeRects[0].toPoints(),void this.dockWatchers.unshift(this.nodeRects[0].center);this.rect&&(this.dockWatchers=this.rect.toPoints(),this.dockWatchers.unshift(this.rect.center))},t}();e.ActiveLayer=m},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(320),o=n(325),c=n(321),h=n(324),l=function(){function t(t){var e=this;void 0===t&&(t={}),this.options=t,this.data=r.Store.get("topology-data"),this.pens=new Map,this.readyPens=new Map,this.lastNow=0,r.Store.set("LT:AnimateLayer",this),this.options.animateColor||(this.options.animateColor="#ff6600"),this.subscribeUpdate=r.Store.subscribe("LT:updateLines",(function(t){e.updateLines(t)})),this.subscribePlay=r.Store.subscribe("LT:AnimatePlay",(function(t){e.readyPlay(t.tag,!1),e.animate()}))}return t.prototype.getAnimateLine=function(t){var e=new h.Line(t);return e.isAnimate=!0,e.toArrow="",e.fromArrow&&e.fromArrow.indexOf("line")<0&&(e.animateFromSize=e.fromArrowSize+5*e.lineWidth),e.toArrow&&e.toArrow.indexOf("line")<0&&(e.animateToSize=e.toArrowSize+5*e.lineWidth),e.animateStart=t.animateStart,e.lineCap="round",e.fillStyle="#fff",e.strokeStyle=e.animateColor||this.options.animateColor,e.length=e.getLen(),e.fromArrowColor||(e.fromArrowColor=e.strokeStyle||"#222"),e.toArrowColor||(e.toArrowColor=e.strokeStyle||"#222"),e},t.prototype.find=function(t){for(var e=0,n=this.data.pens;e<n.length;e++){var r=n[e];if(r.id===t.id)return r}},t.prototype.readyPlay=function(t,e,n){var r=this;this.readyPens.clear(),n||(n=this.data.pens),n.forEach((function(n){r.readyPens.get(n.id)||(r.pens.get(n.id)?(!n.animateStart||n.animateStart<1)&&r.pens.delete(n.id):((e&&n.animatePlay||t&&n.tags.indexOf(t)>-1)&&(!n.animateStart||n.animateStart<1)&&(n.animateStart=Date.now()),!n.animateStart||n.animateStart<1||(n instanceof c.Node?(n.initAnimateProps(),r.readyPens.set(n.id,n),(t||e)&&n.children&&n.children.length&&r.readyPlay(t,e,n.children)):r.readyPens.set(n.id,r.getAnimateLine(n)))))}))},t.prototype.animate=function(){var t=this;this.timer&&cancelAnimationFrame(this.timer),this.readyPens.forEach((function(e,n){t.readyPens.delete(n),t.pens.set(n,e)})),this.timer=requestAnimationFrame((function(){var e=Date.now();if(e-t.lastNow<30)t.animate();else{t.lastNow=e;var n=!1;t.pens.forEach((function(r,c){if(r.animateStart<1)t.pens.delete(c);else if(!(r.animateStart>e)){var h=r.animate(e);if(r.animateStart<1){if(t.pens.delete(c),r.type===o.PenType.Line){var line=t.find(r);line&&(line.animateStart=0)}h&&t.readyPlay(h,!1)}n=!0}})),n&&(r.Store.set("LT:render",!0),t.animate())}}))},t.prototype.updateLines=function(t){this.pens.forEach((function(line,e){if(line instanceof h.Line)for(var n=0,r=t;n<r.length;n++){var o=r[n];line.id===o.id&&(line.from=o.from,line.to=o.to,line.controlPoints=o.controlPoints,line.length=line.getLen())}}))},t.prototype.render=function(t){this.pens.forEach((function(line,e){line instanceof h.Line&&line.render(t)}))},t.prototype.stop=function(){this.readyPens.clear(),this.pens.clear(),this.timer&&cancelAnimationFrame(this.timer)},t.prototype.destroy=function(){this.stop(),this.subscribeUpdate.unsubscribe(),this.subscribePlay.unsubscribe()},t}();e.AnimateLayer=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(320),o=n(321),c=n(329),h=n(325),l=function(){function t(t,e){var n=this;void 0===e&&(e={}),this.parentElem=t,this.options=e,this.data=r.Store.get("topology-data"),this.canvas=document.createElement("div"),this.player=document.createElement("div"),this.videos={},this.audios={},this.iframes={},this.elements={},this.gifs={},this.addDiv=function(t){if(t.audio&&(n.audios[t.id]&&n.audios[t.id].media.src!==t.audio&&(n.audios[t.id].media.src=t.audio),n.setElemPosition(t,n.audios[t.id]&&n.audios[t.id].player||n.addMedia(t,"audio"))),t.video&&(n.videos[t.id]&&n.videos[t.id].media.src!==t.video&&(n.videos[t.id].media.src=t.video),n.setElemPosition(t,n.videos[t.id]&&n.videos[t.id].player||n.addMedia(t,"video"))),t.iframe&&(n.iframes[t.id]&&n.iframes[t.id].src!==t.iframe&&(n.iframes[t.id].src=t.iframe),n.setElemPosition(t,n.iframes[t.id]||n.addIframe(t))),t.elementId&&(n.elements[t.id]||(n.elements[t.id]=document.getElementById(t.elementId),n.elements[t.id]&&n.canvas.appendChild(n.elements[t.id])),n.setElemPosition(t,n.elements[t.id])),t.gif&&(t.image.indexOf(".gif")<0?(t.gif=!1,n.canvas.removeChild(n.gifs[t.id]),n.gifs[t.id]=null):(n.gifs[t.id]&&n.gifs[t.id].src!==t.image&&(n.gifs[t.id].src=t.image),n.setElemPosition(t,n.gifs[t.id]||n.addGif(t)))),t.children)for(var e=0,r=t.children;e<r.length;e++){var o=r[e];o.type!==h.PenType.Line&&n.addDiv(o)}},this.options.playIcon||(this.options.playIcon="iconfont icon-play"),this.options.pauseIcon||(this.options.pauseIcon="iconfont icon-pause"),this.options.fullScreenIcon||(this.options.fullScreenIcon="iconfont icon-full-screen"),this.options.loopIcon||(this.options.loopIcon="iconfont icon-loop"),this.canvas.style.position="absolute",this.canvas.style.left="0",this.canvas.style.top="0",this.canvas.style.outline="none",this.canvas.style.background="transparent",t.appendChild(this.canvas),t.appendChild(this.player),this.createPlayer(),this.subcribe=r.Store.subscribe("LT:addDiv",this.addDiv),this.subcribeNode=r.Store.subscribe("LT:activeNode",(function(t){if(t&&(t.video||t.audio)){if(t.audio&&n.audios[t.id])n.media=n.audios[t.id].media;else{if(!t.video||!n.videos[t.id])return;n.media=n.videos[t.id].media}n.curNode=t,n.player.style.top=n.parentElem.offsetTop+n.parentElem.clientHeight+"px",n.player.style.left=n.parentElem.getBoundingClientRect().left+"px",n.player.style.width=n.parentElem.clientWidth+"px",n.getMediaCurrent(),n.media.paused?n.playBtn.className=n.options.playIcon:n.playBtn.className=n.options.pauseIcon}else n.player.style.top="-99999px"})),document.addEventListener("fullscreenchange",(function(t){n.media&&(document.fullscreen?(n.media.controls=!0,n.media.style.userSelect="initial",n.media.style.pointerEvents="initial"):(n.media.style.userSelect="none",n.media.style.pointerEvents="none",n.media.controls=!1))}))}return t.prototype.createPlayer=function(){var t=this;this.player.style.position="fixed",this.player.style.outline="none",this.player.style.top="-99999px",this.player.style.height="40px",this.player.style.padding="10px 15px",this.player.style.background="rgba(200,200,200,.1)",this.player.style.display="flex",this.player.style.alignItems="center",this.player.style.userSelect="initial",this.player.style.pointerEvents="initial",this.player.style.zIndex="1",this.playBtn=document.createElement("i"),this.currentTime=document.createElement("span"),this.progress=document.createElement("div"),this.progressCurrent=document.createElement("div"),this.loop=document.createElement("i");var e=document.createElement("i");this.playBtn.className=this.options.playIcon,this.playBtn.style.fontSize="18px",this.playBtn.style.lineHeight="20px",this.playBtn.style.cursor="pointer",this.currentTime.style.padding="0 10px",this.currentTime.innerText="0 / 0",this.progress.style.position="relative",this.progress.style.flexGrow="1",this.progress.style.top="0",this.progress.style.height="4px",this.progress.style.background="#ccc",this.progress.style.borderRadius="2px",this.progress.style.overflow="hidden",this.progress.style.cursor="pointer",this.progressCurrent.style.position="absolute",this.progressCurrent.style.left="0",this.progressCurrent.style.top="0",this.progressCurrent.style.bottom="0",this.progressCurrent.style.width="0",this.progressCurrent.style.background="#52c41a",this.loop.style.margin="0 10px",this.loop.style.padding="2px 5px",this.loop.style.borderRadius="2px",this.loop.className=this.options.loopIcon,this.loop.style.fontSize="18px",this.loop.style.lineHeight="20px",this.loop.style.cursor="pointer",e.className=this.options.fullScreenIcon,e.style.fontSize="17px",e.style.lineHeight="20px",e.style.cursor="pointer",this.player.appendChild(this.playBtn),this.player.appendChild(this.currentTime),this.player.appendChild(this.progress),this.progress.appendChild(this.progressCurrent),this.player.appendChild(this.loop),this.player.appendChild(e),this.playBtn.onclick=function(){t.media.paused?(t.media.play(),t.playBtn.className=t.options.pauseIcon):(t.media.pause(),t.playBtn.className=t.options.playIcon)},this.progress.onclick=function(e){t.media.currentTime=e.offsetX/t.progress.clientWidth*t.media.duration},this.loop.onclick=function(){t.media.loop=!t.media.loop,t.curNode.playLoop=t.media.loop,t.media.loop?t.loop.style.background="#ddd":t.loop.style.background="none"},e.onclick=function(){t.media.requestFullscreen()}},t.prototype.getMediaCurrent=function(){this.media&&(this.currentTime.innerText=this.formatSeconds(this.media.currentTime)+" / "+this.formatSeconds(this.media.duration),this.progressCurrent.style.width=this.media.currentTime/this.media.duration*this.progress.clientWidth+"px")},t.prototype.addMedia=function(t,e){var n=this,o=document.createElement("div"),c=document.createElement("div"),h=document.createElement(e);return c.style.position="absolute",c.style.outline="none",c.style.left="0",c.style.bottom="0",c.style.height="2px",c.style.background="#52c41a",h.style.position="absolute",h.style.outline="none",h.style.left="0",h.style.right="0",h.style.top="0",h.style.bottom="0","video"===e&&(h.style.width=t.rect.width+"px",h.style.height=t.rect.height+"px"),o.style.background="transparent",1===t.play&&(h.autoplay=!0),h.loop=t.playLoop,h.ontimeupdate=function(){c.style.width=h.currentTime/h.duration*t.rect.width+"px",n.getMediaCurrent(),n.media===h&&(t.playLoop?(h.loop=!0,n.loop.style.background="#ddd"):(h.loop=!1,n.loop.style.background="none"))},h.onended=function(){r.Store.set("mediaEnd",t),n.media===h&&(n.playBtn.className=n.options.playIcon),n.playNext(t.nextPlay)},h.onloadedmetadata=function(){n.getMediaCurrent()},h.src=t[e],o.appendChild(h),o.appendChild(c),this[e+"s"][t.id]={player:o,current:c,media:h},this.canvas.appendChild(o),o},t.prototype.playNext=function(t){if(t)for(var e=0,n=this.data.pens;e<n.length;e++){var r=n[e];r instanceof o.Node&&(r.tags.indexOf(t)>-1&&(r.audio&&this.audios[r.id]&&this.audios[r.id].media&&this.audios[r.id].media.paused?this.audios[r.id].media.play():r.video&&this.videos[r.id].media&&this.videos[r.id].media.paused&&this.videos[r.id].media.play()))}},t.prototype.addIframe=function(t){var iframe=document.createElement("iframe");return iframe.scrolling="no",iframe.frameBorder="0",iframe.src=t.iframe,this.iframes[t.id]=iframe,this.canvas.appendChild(iframe),iframe},t.prototype.addGif=function(t){return this.gifs[t.id]=t.img,this.canvas.appendChild(t.img),t.img},t.prototype.setElemPosition=function(t,e){e&&(e.style.position="absolute",e.style.outline="none",e.style.left=t.rect.x+"px",e.style.top=t.rect.y+"px",e.style.width=t.rect.width+"px",e.style.height=t.rect.height+"px",(t.rotate||t.offsetRotate)&&(e.style.transform="rotate("+(t.rotate+t.offsetRotate)+"deg)"),t.video&&this.videos[t.id]&&this.videos[t.id].media&&(this.videos[t.id].media.style.width="100%",this.videos[t.id].media.style.height="100%"),this.data.locked<c.Lock.Readonly?(e.style.userSelect="none",e.style.pointerEvents="none"):(e.style.userSelect="initial",e.style.pointerEvents="initial"))},t.prototype.removeDiv=function(t){if(this.curNode&&t.id===this.curNode.id&&(this.curNode=null,this.media=null,this.player.style.top="-99999px"),t.audio&&(this.canvas.removeChild(this.audios[t.id].player),this.audios[t.id]=null),t.video&&(this.canvas.removeChild(this.videos[t.id].player),this.videos[t.id]=null),t.iframe&&(this.canvas.removeChild(this.iframes[t.id]),this.iframes[t.id]=null),t.elementId&&(this.canvas.removeChild(this.elements[t.id]),this.elements[t.id]=null),t.gif&&(this.canvas.removeChild(this.gifs[t.id]),this.gifs[t.id]=null),t.children)for(var e=0,n=t.children;e<n.length;e++){var r=n[e];r.type!==h.PenType.Line&&this.removeDiv(r)}},t.prototype.clear=function(){this.canvas.innerHTML="",this.audios={},this.videos={},this.iframes={},this.elements={},this.gifs={}},t.prototype.formatSeconds=function(t){var e=Math.floor(t/3600),n=Math.floor(t/60)%60,s=Math.floor(t%60),r=s+"";return r=n?n+":"+s:"0:"+s,e&&(r=e+":"+n+":"+s),r},t.prototype.resize=function(t){t?(this.canvas.style.width=t.width+"px",this.canvas.style.height=t.height+"px"):(this.options.width&&"auto"!==this.options.width?this.canvas.style.width=this.options.width+"px":this.canvas.style.width=this.parentElem.clientWidth+"px",this.options.height&&"auto"!==this.options.height?this.canvas.style.height=this.options.height+"px":this.canvas.style.height=this.parentElem.clientHeight-8+"px")},t.prototype.render=function(){for(var t=0,e=this.data.pens;t<e.length;t++){var n=e[t];this.addDiv(n)}},t.prototype.destroy=function(){this.clear(),this.subcribe.unsubscribe(),this.subcribeNode.unsubscribe()},t}();e.DivLayer=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(348),o=function(){function t(t,e){var n=this;this.url=t,this.pens=e,this.onmessage=function(t){if(n.pens.length&&t&&t.data)try{for(var e=JSON.parse(t.data),o=0,c=n.pens;o<c.length;o++)for(var h=c[o],l=0,d=h.events;l<d.length;l++){var f=d[l];f.type===r.EventType.WebSocket&&f.name===e.event&&h.doSocket(f,e.data,n.socket)}}catch(t){}},this.init()}return t.prototype.init=function(){var t=this;this.socket=new WebSocket(this.url),this.socket.onmessage=this.onmessage,this.socket.onclose=function(){console.log("Canvas websocket closed and reconneting..."),t.init()}},t.prototype.close=function(){this.socket.onclose=null,this.socket.close()},t}();e.Socket=o},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(326)),r(n(334)),r(n(333)),r(n(347)),r(n(330))},function(t,e,n){(function(n){var r,o,c;o=[],void 0===(c="function"==typeof(r=function(){"use strict";function e(b,t,e){var n=new XMLHttpRequest;n.open("GET",b),n.responseType="blob",n.onload=function(){a(n.response,t,e)},n.onerror=function(){console.error("could not download file")},n.send()}function r(a){var b=new XMLHttpRequest;b.open("HEAD",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function o(a){try{a.dispatchEvent(new MouseEvent("click"))}catch(t){var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var c="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,a=c.saveAs||("object"!=typeof window||window!==c?function(){}:"download"in HTMLAnchorElement.prototype?function(b,g,t){var i=c.URL||c.webkitURL,n=document.createElement("a");g=g||b.name||"download",n.download=g,n.rel="noopener","string"==typeof b?(n.href=b,n.origin===location.origin?o(n):r(n.href)?e(b,g,t):o(n,n.target="_blank")):(n.href=i.createObjectURL(b),setTimeout((function(){i.revokeObjectURL(n.href)}),4e4),setTimeout((function(){o(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,g,n){if(g=g||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(a,b){return void 0===b?b={autoBom:!1}:"object"!=typeof b&&(console.warn("Deprecated: Expected third argument to be a object"),b={autoBom:!b}),b.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\ufeff",a],{type:a.type}):a}(t,n),g);else if(r(t))e(t,g,n);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout((function(){o(i)}))}}:function(a,b,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof a)return e(a,b,t);var g="application/octet-stream"===a.type,r=/constructor/i.test(c.HTMLElement)||c.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||g&&r)&&"object"==typeof FileReader){var o=new FileReader;o.onloadend=function(){var a=o.result;a=i?a:a.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=a:location=a,n=null},o.readAsDataURL(a)}else{var h=c.URL||c.webkitURL,l=h.createObjectURL(a);n?n.location=l:location.href=l,n=null,setTimeout((function(){h.revokeObjectURL(l)}),4e4)}});c.saveAs=a.saveAs=a,t.exports=a})?r.apply(e,o):r)||(t.exports=c)}).call(this,n(26))},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(415)),r(n(420)),r(n(423)),r(n(426)),r(n(430)),r(n(433)),r(n(437)),r(n(440)),r(n(444)),r(n(448)),r(n(451))},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(416)),r(n(417)),r(n(418))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowData=function(t,e){t.beginPath();var n=e.rect.width/7<<0;t.moveTo(e.rect.x+n,e.rect.y),t.lineTo(e.rect.ex,e.rect.y),t.lineTo(e.rect.x+e.rect.width-n,e.rect.ey),t.lineTo(e.rect.x,e.rect.ey),t.closePath(),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322),o=n(328);e.flowDataAnchors=function(t){t.anchors.push(new r.Point(t.rect.x+t.rect.width/14,t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+4*t.rect.width/7,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+13*t.rect.width/14,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+3*t.rect.width/7,t.rect.ey,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowDataIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowDataTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.width/7,t.rect.y,5*t.rect.width/7,t.rect.height),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322);function o(t,e){if(e.length<3)return!1;for(var n=!1,r=e[e.length-1],o=0,c=e;o<c.length;o++){var h=c[o];(h.y<t.y&&r.y>=t.y||h.y>=t.y&&r.y<t.y)&&h.x+(t.y-h.y)*(r.x-h.x)/(r.y-h.y)>t.x&&(n=!n),r=h}return n}e.pointInRect=o,e.pointInLine=function(t,e,n){return o(t,[new r.Point(e.x-8,e.y-8),new r.Point(n.x-8,n.y-8),new r.Point(n.x+8,n.y+8),new r.Point(e.x+8,e.y+8)])},e.lineLen=function(t,e){return 0|Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2))},e.curveLen=function(t,e,n,r){var path=document.createElementNS("http://www.w3.org/2000/svg","path");return path.setAttribute("d","M"+t.x+" "+t.y+" C"+e.x+" "+e.y+" "+n.x+" "+n.y+" "+r.x+" "+r.y),0|path.getTotalLength()},e.pSBC=function(p,t,e,n){var r,g,b,o,c,h,l,a="string"==typeof e,i=parseInt,d=Math.round;if("number"!=typeof p||p<-1||p>1||"string"!=typeof t||"r"!==t[0]&&"#"!==t[0]||e&&!a)return null;var f=function(t){var e,n=t.length,o={};if(n>9){if(e=t=t.split(","),r=e[0],g=e[1],b=e[2],a=e[3],(n=t.length)<3||n>4)return null;o.r=i("a"===r[3]?r.slice(5):r.slice(4)),o.g=i(g),o.b=i(b),o.a=a?parseFloat(a):-1}else{if(8===n||6===n||n<4)return null;n<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(n>4?t[4]+t[4]:"")),t=i(t.slice(1),16),9===n||5===n?(o.r=t>>24&255,o.g=t>>16&255,o.b=t>>8&255,o.a=d((255&t)/.255)/1e3):(o.r=t>>16,o.g=t>>8&255,o.b=255&t,o.a=-1)}return o};return l=t.length>9,l=a?e.length>9||"c"===e&&!l:l,c=f(t),o=p<0,h=e&&"c"!==e?f(e):o?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},o=1-(p=o?-1*p:p),c&&h?(n?(r=d(o*c.r+p*h.r),g=d(o*c.g+p*h.g),b=d(o*c.b+p*h.b)):(r=d(Math.pow(o*Math.pow(c.r,2)+p*Math.pow(h.r,2),.5)),g=d(Math.pow(o*Math.pow(c.g,2)+p*Math.pow(h.g,2),.5)),b=d(Math.pow(o*Math.pow(c.b,2)+p*Math.pow(h.b,2),.5))),a=c.a,h=h.a,a=(c=a>=0||h>=0)?a<0?h:h<0?a:a*o+h*p:0,l?"rgb"+(c?"a(":"(")+r+","+g+","+b+(c?","+d(1e3*a)/1e3:"")+")":"#"+(4294967296+16777216*r+65536*g+256*b+(c?d(255*a):0)).toString(16).slice(1,c?void 0:-2)):null}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(421)),r(n(422))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowSubprocess=function(t,e){t.beginPath();var n=e.rect.width/7<<0;t.moveTo(e.rect.x,e.rect.y),t.lineTo(e.rect.ex,e.rect.y),t.lineTo(e.rect.ex,e.rect.ey),t.lineTo(e.rect.x,e.rect.ey),t.closePath(),t.moveTo(e.rect.x+n,e.rect.y),t.lineTo(e.rect.x+n,e.rect.ey),t.moveTo(e.rect.ex-n,e.rect.y),t.lineTo(e.rect.ex-n,e.rect.ey),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowSubprocessIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowSubprocessTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.width/7,t.rect.y,5*t.rect.width/7,t.rect.height),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(424)),r(n(425))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowDb=function(t,e){t.beginPath();var n=e.rect.height/7<<0;t.moveTo(e.rect.x,e.rect.y+n),t.bezierCurveTo(e.rect.x,e.rect.y-n/2|0,e.rect.ex,e.rect.y-n/2|0,e.rect.ex,e.rect.y+n),t.lineTo(e.rect.ex,e.rect.ey-n),t.bezierCurveTo(e.rect.ex,e.rect.ey+n/2|0,e.rect.x,e.rect.ey+n/2|0,e.rect.x,e.rect.ey-n),t.closePath(),t.moveTo(e.rect.x,e.rect.ey-n),t.bezierCurveTo(e.rect.x,e.rect.ey-2*n|0,e.rect.ex,e.rect.ey-2*n|0,e.rect.ex,e.rect.ey-n),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowDbIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowDbTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y+t.rect.height/8,t.rect.width,5*t.rect.height/8),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(427)),r(n(428)),r(n(429))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowDocument=function(t,e){t.beginPath();var n=e.rect.x+e.rect.width/2<<0,r=e.rect.y+6*e.rect.height/7<<0,o=e.rect.height/6<<0;t.moveTo(e.rect.x,e.rect.y),t.lineTo(e.rect.ex,e.rect.y),t.lineTo(e.rect.ex,r),t.bezierCurveTo(e.rect.ex-20,r-o,n+e.rect.width/5<<0,r-o,n,r),t.bezierCurveTo(n-e.rect.width/5<<0,r+o,e.rect.x,r+o,e.rect.x,r),t.closePath(),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322),o=n(328);e.flowDocumentAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+6*t.rect.height/7,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowDocumentIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowDocumentTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y,t.rect.width,5*t.rect.height/7),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(431)),r(n(432))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowInternalStorage=function(t,e){t.beginPath(),t.moveTo(e.rect.x,e.rect.y),t.lineTo(e.rect.ex,e.rect.y),t.lineTo(e.rect.ex,e.rect.ey),t.lineTo(e.rect.x,e.rect.ey),t.closePath();var n=e.rect.width/7<<0;t.moveTo(e.rect.x,e.rect.y+n),t.lineTo(e.rect.ex,e.rect.y+n),t.moveTo(e.rect.x+n,e.rect.y),t.lineTo(e.rect.x+n,e.rect.ey),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowInternalStorageIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowInternalStorageTextRect=function(t){var e=t.rect.width/7;t.textRect=new r.Rect(t.rect.x+e,t.rect.y+e,t.rect.width-e,t.rect.height-e),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(434)),r(n(435)),r(n(436))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowExternStorage=function(t,e){t.beginPath();var n=e.rect.width/10<<0;t.moveTo(e.rect.x+2*n,e.rect.y),t.bezierCurveTo(e.rect.x-2*n/3<<0,e.rect.y,e.rect.x-2*n/3<<0,e.rect.ey,e.rect.x+2*n,e.rect.ey),t.lineTo(e.rect.ex,e.rect.ey),t.bezierCurveTo(e.rect.ex-n,e.rect.ey,e.rect.ex-n,e.rect.y,e.rect.ex,e.rect.y),t.closePath(),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322),o=n(328);e.flowExternStorageAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+8*t.rect.width/15,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+13*t.rect.width/14,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+8*t.rect.width/15,t.rect.ey,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowExternStorageIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowExternStorageTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.width/6,t.rect.y,3*t.rect.width/4,t.rect.height),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(438)),r(n(439))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowQueue=function(t,e){t.beginPath(),t.ellipse(e.rect.x+(e.rect.width/2<<0),e.rect.y+(e.rect.height/2<<0),e.rect.width/2<<0,e.rect.height/2<<0,0,0,2*Math.PI),t.moveTo(e.rect.x+e.rect.width/2<<0,e.rect.ey),t.lineTo(e.rect.ex,e.rect.ey),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowQueueIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowQueueTextRect=function(t){var e=5*t.rect.width/7,n=5*t.rect.height/7;t.textRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+(t.rect.height-n)/2,e,n),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(441)),r(n(442)),r(n(443))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowManually=function(t,e){t.beginPath();var n=e.rect.height/4<<0;t.moveTo(e.rect.x,e.rect.y+n),t.lineTo(e.rect.ex,e.rect.y),t.lineTo(e.rect.ex,e.rect.ey),t.lineTo(e.rect.x,e.rect.ey),t.closePath(),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322),o=n(328);e.flowManuallyAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+5*t.rect.height/8,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height/8,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.ex,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.ey,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowManuallyIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowManuallyTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y+t.rect.height/4,t.rect.width,3*t.rect.height/4),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(445)),r(n(446)),r(n(447))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowDisplay=function(t,e){t.beginPath();var n=e.rect.width/8<<0;t.moveTo(e.rect.x+n,e.rect.y),t.lineTo(e.rect.ex-n,e.rect.y),t.bezierCurveTo(e.rect.ex+n/3<<0,e.rect.y,e.rect.ex+n/3<<0,e.rect.ey,e.rect.ex-n,e.rect.ey),t.lineTo(e.rect.x+n,e.rect.ey),t.lineTo(e.rect.x,e.rect.y+e.rect.height/2<<0),t.closePath(),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322),o=n(328);e.flowDisplayAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+t.rect.height/2,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height,o.Direction.Bottom))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(323);e.flowDisplayIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.flowDisplayTextRect=function(t){t.textRect=new r.Rect(t.rect.x+t.rect.width/8,t.rect.y,3*t.rect.width/4,t.rect.height),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(449)),r(n(450))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowParallel=function(t,e){t.beginPath(),t.moveTo(e.rect.x,e.rect.y),t.lineTo(e.rect.ex,e.rect.y),t.moveTo(e.rect.x,e.rect.ey),t.lineTo(e.rect.ex,e.rect.ey),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322),o=n(328);e.flowParallelAnchors=function(t){t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+t.rect.height,o.Direction.Bottom))}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(452)),r(n(453))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flowComment=function(t,e){t.beginPath();var n=e.rect.width/4<<0;t.moveTo(e.rect.x+n,e.rect.y),t.lineTo(e.rect.x,e.rect.y),t.lineTo(e.rect.x,e.rect.ey),t.lineTo(e.rect.x+n,e.rect.ey),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(322),o=n(328);e.flowCommentAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left))}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(455)),r(n(458)),r(n(462)),r(n(465))},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(456)),r(n(457))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.activityFinal=function(t,e){t.beginPath(),t.ellipse(e.rect.x+(e.rect.width/2<<0),e.rect.y+(e.rect.height/2<<0),e.rect.width/2<<0,e.rect.height/2<<0,0,0,2*Math.PI),t.stroke(),t.beginPath(),t.fillStyle=t.strokeStyle,t.ellipse(e.rect.x+(e.rect.width/2<<0),e.rect.y+(e.rect.height/2<<0),e.rect.width/4<<0,e.rect.height/4<<0,0,0,2*Math.PI),t.fill()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.activityFinalIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.activityFinalTextRect=function(t){var e=5*t.rect.width/7,n=5*t.rect.height/7;t.textRect=new r.Rect(t.rect.x+(t.rect.width-e)/2,t.rect.y+(t.rect.height-n)/2,e,n),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(459)),r(n(460)),r(n(461))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fork=function(t,e){var n=e.rect.width*e.borderRadius,hr=e.rect.height*e.borderRadius,r=n<hr?n:hr;e.rect.width<2*r&&(r=e.rect.width/2),e.rect.height<2*r&&(r=e.rect.height/2),t.beginPath(),t.moveTo(e.rect.x+r,e.rect.y),t.arcTo(e.rect.x+e.rect.width,e.rect.y,e.rect.x+e.rect.width,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height,e.rect.x,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x,e.rect.y+e.rect.height,e.rect.x,e.rect.y,r),t.arcTo(e.rect.x,e.rect.y,e.rect.x+e.rect.width,e.rect.y,r),t.closePath(),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.forkIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.forkTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y,t.rect.width,t.rect.height),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.forkHAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+t.rect.height/2,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.ex,t.rect.y+t.rect.height/2,o.Direction.Right));for(var i=25;t.rect.x+i<t.rect.ex;i+=25){var e=new r.Point(t.rect.x+i,t.rect.y,o.Direction.Up),n=new r.Point(t.rect.x+i,t.rect.ey,o.Direction.Bottom);e.data="hidden",n.data="hidden",t.anchors.push(e),t.anchors.push(n)}},e.forkVAnchors=function(t){t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.ey,o.Direction.Bottom));for(var i=25;t.rect.y+i<t.rect.ey;i+=25){var e=new r.Point(t.rect.x,t.rect.y+i,o.Direction.Left),n=new r.Point(t.rect.ex,t.rect.y+i,o.Direction.Right);e.data="hidden",n.data="hidden",t.anchors.push(e),t.anchors.push(n)}}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(463)),r(n(464))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.swimlaneH=function(t,e){var n=e.rect.width*e.borderRadius,hr=e.rect.height*e.borderRadius,r=n<hr?n:hr;e.rect.width<2*r&&(r=e.rect.width/2),e.rect.height<2*r&&(r=e.rect.height/2),t.beginPath(),t.moveTo(e.rect.x+r,e.rect.y),t.arcTo(e.rect.x+e.rect.width,e.rect.y,e.rect.x+e.rect.width,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height,e.rect.x,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x,e.rect.y+e.rect.height,e.rect.x,e.rect.y,r),t.arcTo(e.rect.x,e.rect.y,e.rect.x+e.rect.width,e.rect.y,r),t.closePath(),t.moveTo(e.rect.x+40,e.rect.y),t.lineTo(e.rect.x+40,e.rect.ey),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.swimlaneHIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.swimlaneHTextRect=function(t){t.textRect=new r.Rect(t.rect.x+10,t.rect.y,20,t.rect.height),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(466)),r(n(467))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.swimlaneV=function(t,e){var n=e.rect.width*e.borderRadius,hr=e.rect.height*e.borderRadius,r=n<hr?n:hr;e.rect.width<2*r&&(r=e.rect.width/2),e.rect.height<2*r&&(r=e.rect.height/2),t.beginPath(),t.moveTo(e.rect.x+r,e.rect.y),t.arcTo(e.rect.x+e.rect.width,e.rect.y,e.rect.x+e.rect.width,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height,e.rect.x,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x,e.rect.y+e.rect.height,e.rect.x,e.rect.y,r),t.arcTo(e.rect.x,e.rect.y,e.rect.x+e.rect.width,e.rect.y,r),t.closePath(),t.moveTo(e.rect.x,e.rect.y+40),t.lineTo(e.rect.ex,e.rect.y+40),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.swimlaneVIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.swimlaneVTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y,t.rect.width,40),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}(n(469))},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(470)),r(n(471))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.simpleClass=function(t,e){var n=e.rect.width*e.borderRadius,hr=e.rect.height*e.borderRadius,r=n<hr?n:hr;e.rect.width<2*r&&(r=e.rect.width/2),e.rect.height<2*r&&(r=e.rect.height/2),t.beginPath(),t.moveTo(e.rect.x+r,e.rect.y),t.arcTo(e.rect.x+e.rect.width,e.rect.y,e.rect.x+e.rect.width,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height,e.rect.x,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x,e.rect.y+e.rect.height,e.rect.x,e.rect.y,r),t.arcTo(e.rect.x,e.rect.y,e.rect.x+e.rect.width,e.rect.y,r),t.closePath(),t.moveTo(e.rect.x,e.rect.y+40),t.lineTo(e.rect.ex,e.rect.y+40),t.fill(),t.stroke()},e.interfaceClass=function(t,e){var n=e.rect.width*e.borderRadius,hr=e.rect.height*e.borderRadius,r=n<hr?n:hr;e.rect.width<2*r&&(r=e.rect.width/2),e.rect.height<2*r&&(r=e.rect.height/2),t.beginPath(),t.moveTo(e.rect.x+r,e.rect.y),t.arcTo(e.rect.x+e.rect.width,e.rect.y,e.rect.x+e.rect.width,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x+e.rect.width,e.rect.y+e.rect.height,e.rect.x,e.rect.y+e.rect.height,r),t.arcTo(e.rect.x,e.rect.y+e.rect.height,e.rect.x,e.rect.y,r),t.arcTo(e.rect.x,e.rect.y,e.rect.x+e.rect.width,e.rect.y,r),t.closePath(),t.moveTo(e.rect.x,e.rect.y+40),t.lineTo(e.rect.ex,e.rect.y+40);var o=e.rect.y+20+e.rect.height/2<<0;t.moveTo(e.rect.x,o),t.lineTo(e.rect.ex,o),t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(472);e.simpleClassIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.simpleClassTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y,t.rect.width,40),t.fullTextRect=t.textRect},e.interfaceClassIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.interfaceClassTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y,t.rect.width,40),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(349),o=n(473),c=function(){function t(t,e,n,o){this.x=t,this.y=e,this.width=n,this.height=o,this.center=new r.Point(0,0),this.x=this.x<<0,this.y=this.y<<0,this.width=this.width<<0,this.height=this.height<<0,this.ex=this.x+this.width,this.ey=this.y+this.height,this.calceCenter()}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.hit=function(t,e){return void 0===e&&(e=0),t.x>this.x-e&&t.x<this.ex+e&&t.y>this.y-e&&t.y<this.ey+e},t.prototype.hitRect=function(rect){return rect.x>this.x&&rect.x<this.ex&&rect.y>this.y&&rect.y<this.ey||rect.ex>this.x&&rect.ex<this.ex&&rect.y>this.y&&rect.y<this.ey||rect.ex>this.x&&rect.ex<this.ex&&rect.ey>this.y&&rect.ey<this.ey||rect.x>this.x&&rect.x<this.ex&&rect.ey>this.y&&rect.ey<this.ey},t.prototype.hitRotate=function(t,e,n){for(var r=this.toPoints(),c=0,h=r;c<h.length;c++){h[c].rotate(e,n)}return o.pointInRect(t,r)},t.prototype.calceCenter=function(){this.center.x=this.x+this.width/2<<0,this.center.y=this.y+this.height/2<<0},t.prototype.toPoints=function(){return[new r.Point(this.x,this.y),new r.Point(this.ex,this.y),new r.Point(this.ex,this.ey),new r.Point(this.x,this.ey)]},t}();e.Rect=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(349);function o(t,e){if(e.length<3)return!1;for(var n=!1,r=e[e.length-1],o=0,c=e;o<c.length;o++){var h=c[o];(h.y<t.y&&r.y>=t.y||h.y>=t.y&&r.y<t.y)&&h.x+(t.y-h.y)*(r.x-h.x)/(r.y-h.y)>t.x&&(n=!n),r=h}return n}e.pointInRect=o,e.pointInLine=function(t,e,n){return o(t,[new r.Point(e.x-8,e.y-8),new r.Point(n.x-8,n.y-8),new r.Point(n.x+8,n.y+8),new r.Point(e.x+8,e.y+8)])},e.lineLen=function(t,e){return 0|Math.sqrt(Math.pow(Math.abs(t.x-e.x),2)+Math.pow(Math.abs(t.y-e.y),2))},e.curveLen=function(t,e,n,r){var path=document.createElementNS("http://www.w3.org/2000/svg","path");return path.setAttribute("d","M"+t.x+" "+t.y+" C"+e.x+" "+e.y+" "+n.x+" "+n.y+" "+r.x+" "+r.y),0|path.getTotalLength()},e.pSBC=function(p,t,e,n){var r,g,b,o,c,h,l,a="string"==typeof e,i=parseInt,d=Math.round;if("number"!=typeof p||p<-1||p>1||"string"!=typeof t||"r"!==t[0]&&"#"!==t[0]||e&&!a)return null;var f=function(t){var e,n=t.length,o={};if(n>9){if(e=t=t.split(","),r=e[0],g=e[1],b=e[2],a=e[3],(n=t.length)<3||n>4)return null;o.r=i("a"===r[3]?r.slice(5):r.slice(4)),o.g=i(g),o.b=i(b),o.a=a?parseFloat(a):-1}else{if(8===n||6===n||n<4)return null;n<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(n>4?t[4]+t[4]:"")),t=i(t.slice(1),16),9===n||5===n?(o.r=t>>24&255,o.g=t>>16&255,o.b=t>>8&255,o.a=d((255&t)/.255)/1e3):(o.r=t>>16,o.g=t>>8&255,o.b=255&t,o.a=-1)}return o};return l=t.length>9,l=a?e.length>9||"c"===e&&!l:l,c=f(t),o=p<0,h=e&&"c"!==e?f(e):o?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},o=1-(p=o?-1*p:p),c&&h?(n?(r=d(o*c.r+p*h.r),g=d(o*c.g+p*h.g),b=d(o*c.b+p*h.b)):(r=d(Math.pow(o*Math.pow(c.r,2)+p*Math.pow(h.r,2),.5)),g=d(Math.pow(o*Math.pow(c.g,2)+p*Math.pow(h.g,2),.5)),b=d(Math.pow(o*Math.pow(c.b,2)+p*Math.pow(h.b,2),.5))),a=c.a,h=h.a,a=(c=a>=0||h>=0)?a<0?h:h<0?a:a*o+h*p:0,l?"rgb"+(c?"a(":"(")+r+","+g+","+b+(c?","+d(1e3*a)/1e3:"")+")":"#"+(4294967296+16777216*r+65536*g+256*b+(c?d(255*a):0)).toString(16).slice(1,c?void 0:-2)):null}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(475)),r(n(479))},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(476)),r(n(477)),r(n(478))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.lifeline=function(t,e){var n=e.rect.width*e.borderRadius,hr=50*e.borderRadius,r=n<hr?n:hr;e.rect.width<2*r&&(r=e.rect.width/2),50<2*r&&(r=25),t.beginPath(),t.moveTo(e.rect.x+r,e.rect.y),t.arcTo(e.rect.x+e.rect.width,e.rect.y,e.rect.x+e.rect.width,e.rect.y+50,r),t.arcTo(e.rect.x+e.rect.width,e.rect.y+50,e.rect.x,e.rect.y+50,r),t.arcTo(e.rect.x,e.rect.y+50,e.rect.x,e.rect.y,r),t.arcTo(e.rect.x,e.rect.y,e.rect.x+e.rect.width,e.rect.y,r),t.closePath(),t.fill(),t.stroke(),t.save(),t.beginPath(),t.lineWidth=1,t.setLineDash([7,7]);var o=e.rect.x+e.rect.width/2<<0;t.moveTo(o,e.rect.y+50+1),t.lineTo(o,e.rect.ey),t.stroke(),t.restore()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.lifelineIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.lifelineTextRect=function(t){t.textRect=new r.Rect(t.rect.x,t.rect.y,t.rect.width,50),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.lifelineAnchors=function(t){t.anchors.push(new r.Point(t.rect.x,t.rect.y+25,o.Direction.Left)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width,t.rect.y+25,o.Direction.Right)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y+50,o.Direction.Bottom)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.ey,o.Direction.Bottom))}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(480)),r(n(481)),r(n(482))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sequenceFocus=function(t,e){t.beginPath(),t.rect(e.rect.x,e.rect.y,e.rect.width,e.rect.height),this.fillStyle?t.fillStyle=this.fillStyle:t.fillStyle="#fff",t.fill(),t.stroke()}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(317);e.sequenceFocusIconRect=function(t){t.iconRect=new r.Rect(0,0,0,0)},e.sequenceFocusTextRect=function(t){t.textRect=new r.Rect(0,0,0,0),t.fullTextRect=t.textRect}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(318),o=n(319);e.sequenceFocusAnchors=function(t){t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.y,o.Direction.Up)),t.anchors.push(new r.Point(t.rect.x+t.rect.width/2,t.rect.ey,o.Direction.Bottom));for(var i=25;t.rect.y+i<t.rect.ey;i+=25){var e=new r.Point(t.rect.x,t.rect.y+i,o.Direction.Left),n=new r.Point(t.rect.ex,t.rect.y+i,o.Direction.Right);e.data="hidden",n.data="hidden",t.anchors.push(e),t.anchors.push(n)}}},function(t,e,n){"use strict";function r(t){for(var p in t)e.hasOwnProperty(p)||(e[p]=t[p])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(350)),r(n(484))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(327),o=n(334),c=n(350);e.register=function(){window.echarts||o.loadJS("https://cdn.bootcss.com/echarts/4.3.0/echarts.min.js",null,!0),r.registerNode("echarts",c.echarts,null,null,null)}}])]);